const a3_0x54b2ae=a3_0x586c;(function(_0x391572,_0x5e9faa){const _0x3ed074=a3_0x586c,_0xe0a5c1=_0x391572();while(!![]){try{const _0xd845e0=-parseInt(_0x3ed074(0x183))/0x1+-parseInt(_0x3ed074(0x182))/0x2+-parseInt(_0x3ed074(0x175))/0x3+-parseInt(_0x3ed074(0x184))/0x4+-parseInt(_0x3ed074(0x173))/0x5+-parseInt(_0x3ed074(0x16d))/0x6+parseInt(_0x3ed074(0x18d))/0x7;if(_0xd845e0===_0x5e9faa)break;else _0xe0a5c1['push'](_0xe0a5c1['shift']());}catch(_0x4cb0f1){_0xe0a5c1['push'](_0xe0a5c1['shift']());}}}(a3_0xc014,0xb50e0));function a3_0x586c(_0xf336cb,_0xfaea1b){const _0xc01469=a3_0xc014();return a3_0x586c=function(_0x586cb7,_0x460eaf){_0x586cb7=_0x586cb7-0x162;let _0xde81d8=_0xc01469[_0x586cb7];return _0xde81d8;},a3_0x586c(_0xf336cb,_0xfaea1b);}const config=require(a3_0x54b2ae(0x170)),conn=require(a3_0x54b2ae(0x17b)),transporter=require(a3_0x54b2ae(0x17e))[a3_0x54b2ae(0x17a)],getWelcomeEmailTemplate=(_0x57ee0b,_0x3fd4d9)=>{const _0x2800ea=a3_0x54b2ae;return _0x2800ea(0x189)+_0x3fd4d9+_0x2800ea(0x180)+_0x3fd4d9+_0x2800ea(0x167);},sendWelcomeEmail=async(_0x40bb1d,_0x475aa4)=>{const _0x5d82dc=a3_0x54b2ae;try{let _0x3d8e8b=config[_0x5d82dc(0x18e)];_0x3d8e8b[_0x5d82dc(0x181)]('/')&&(_0x3d8e8b=_0x3d8e8b[_0x5d82dc(0x16b)](0x0,-0x1));const _0x58d058=_0x3d8e8b+_0x5d82dc(0x16f)+_0x475aa4,_0x134412=getWelcomeEmailTemplate(_0x40bb1d,_0x58d058),_0x4b40fe={'from':config[_0x5d82dc(0x190)],'to':_0x40bb1d[_0x5d82dc(0x191)],'subject':'Welcome\x20to\x20CADViewer','text':_0x5d82dc(0x163),'html':_0x134412};await transporter[_0x5d82dc(0x165)](_0x4b40fe),console[_0x5d82dc(0x171)](_0x5d82dc(0x172)+_0x40bb1d[_0x5d82dc(0x191)]);}catch(_0x459505){console[_0x5d82dc(0x171)](_0x5d82dc(0x16a)),console['log']('Failed\x20to\x20send\x20welcome\x20email\x20to\x20'+_0x40bb1d[_0x5d82dc(0x191)]+':',_0x459505);throw _0x459505;}},getAccountDeletionPreventionTemplate=_0x1fb124=>{const _0x2778ec=a3_0x54b2ae;return _0x2778ec(0x17c)+(_0x1fb124['first_name']||_0x1fb124[_0x2778ec(0x18f)])+_0x2778ec(0x164);},sendAccountDeletionPreventionEmails=async()=>{const _0x4ad1aa=a3_0x54b2ae;try{const [_0x393ce9]=await conn[_0x4ad1aa(0x187)]()[_0x4ad1aa(0x168)](_0x4ad1aa(0x179),[config[_0x4ad1aa(0x166)]-config[_0x4ad1aa(0x188)]]);if(_0x393ce9['length']===0x0){console['log'](_0x4ad1aa(0x178));return;}for(const _0x348af5 of _0x393ce9){const _0x12569f=getAccountDeletionPreventionTemplate(_0x348af5),_0x43b72b={'from':config['smtpFrom'],'to':_0x348af5[_0x4ad1aa(0x191)],'subject':_0x4ad1aa(0x17f),'text':_0x4ad1aa(0x16c),'html':_0x12569f};try{await transporter[_0x4ad1aa(0x165)](_0x43b72b),console['log']('Deletion\x20prevention\x20email\x20sent\x20to\x20'+_0x348af5[_0x4ad1aa(0x191)]);}catch(_0x7203ce){console[_0x4ad1aa(0x171)](_0x4ad1aa(0x16a)),console[_0x4ad1aa(0x171)](_0x4ad1aa(0x17d)+_0x348af5[_0x4ad1aa(0x191)]),console['log'](_0x7203ce);}}}catch(_0x812595){console['log'](_0x4ad1aa(0x16a)),console[_0x4ad1aa(0x171)]('Error\x20while\x20fetching\x20users\x20for\x20account\x20deletion\x20prevention\x20emails'),console[_0x4ad1aa(0x171)](_0x812595);}},getFollowUpEmailTemplate=(_0x381013,_0x2ee298,_0x3fcb8f)=>{const _0x5b9d78=a3_0x54b2ae,_0x615e99={0x1:'3\x20hours',0x2:'6\x20hours',0x3:'12\x20hours'}[_0x3fcb8f];return _0x5b9d78(0x186)+(_0x381013[_0x5b9d78(0x192)]||_0x381013[_0x5b9d78(0x18f)])+_0x5b9d78(0x18c)+_0x615e99+_0x5b9d78(0x169)+_0x2ee298+_0x5b9d78(0x180)+_0x2ee298+_0x5b9d78(0x167);},sendFollowUpEmails=async()=>{const _0x3eecf1=a3_0x54b2ae;try{const _0xb66b3e=_0x3eecf1(0x174),[_0x5a37c2]=await conn[_0x3eecf1(0x187)]()[_0x3eecf1(0x168)](_0xb66b3e);for(const _0x13e356 of _0x5a37c2){const _0x54ef72=config[_0x3eecf1(0x18e)]+_0x3eecf1(0x16f)+_0x13e356[_0x3eecf1(0x185)],_0x4a5759=getFollowUpEmailTemplate(_0x13e356,_0x54ef72,_0x13e356[_0x3eecf1(0x176)]+0x1),_0x51995d={'from':config[_0x3eecf1(0x190)],'to':_0x13e356[_0x3eecf1(0x191)],'subject':_0x3eecf1(0x18b),'text':'Please\x20validate\x20your\x20CADViewer\x20email\x20address','html':_0x4a5759};try{await transporter[_0x3eecf1(0x165)](_0x51995d),await conn['promise']()[_0x3eecf1(0x168)](_0x3eecf1(0x162),[_0x13e356['id']]),console['log'](_0x3eecf1(0x177)+_0x13e356[_0x3eecf1(0x191)]);}catch(_0x5c7fcf){console['error']('Failed\x20to\x20send\x20follow-up\x20email\x20to\x20'+_0x13e356[_0x3eecf1(0x191)]+':',_0x5c7fcf);}}}catch(_0x3f6174){console[_0x3eecf1(0x16e)]('Error\x20in\x20sendFollowUpEmails:',_0x3f6174);}};function a3_0xc014(){const _0x31af97=['===================error===================','slice','Your\x20CADViewer\x20demo\x20account\x20will\x20expire\x20in\x202\x20days.\x20Please\x20contact\x20an\x20administrator\x20if\x20you\x20wish\x20to\x20keep\x20your\x20account.','183720sObdoA','error','/validate-email/','../CADViewer_config.json','log','Welcome\x20email\x20sent\x20to\x20','6353020USxGMf','\x0a\x20\x20\x20\x20\x20\x20SELECT\x20*\x0a\x20\x20\x20\x20\x20\x20FROM\x20users\x0a\x20\x20\x20\x20\x20\x20WHERE\x20is_enabled\x20=\x200\x0a\x20\x20\x20\x20\x20\x20AND\x20validation_token\x20IS\x20NOT\x20NULL\x0a\x20\x20\x20\x20\x20\x20AND\x20follow_up_count\x20<\x203\x0a\x20\x20\x20\x20\x20\x20AND\x20created_at\x20<=\x20DATE_SUB(NOW(),\x20INTERVAL\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20CASE\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20WHEN\x20follow_up_count\x20=\x200\x20THEN\x203\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20WHEN\x20follow_up_count\x20=\x201\x20THEN\x206\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20WHEN\x20follow_up_count\x20=\x202\x20THEN\x2012\x0a\x20\x20\x20\x20\x20\x20\x20\x20END\x0a\x20\x20\x20\x20\x20\x20HOUR)\x0a\x20\x20\x20\x20','1513521MtPrSK','follow_up_count','Follow-up\x20email\x20sent\x20to\x20','No\x20users\x20to\x20notify\x20about\x20account\x20deletion','SELECT\x20*\x20FROM\x20users\x20WHERE\x20role\x20=\x20\x27demo_user\x27\x20AND\x20created_at\x20<\x20DATE_SUB(NOW(),\x20INTERVAL\x20?\x20DAY)','transporter','./mysql.js','\x0a\x20\x20\x20\x20<!DOCTYPE\x20html>\x0a\x20\x20\x20\x20<html>\x0a\x20\x20\x20\x20\x20\x20<head>\x0a\x20\x20\x20\x20\x20\x20\x20\x20<style>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20body\x20{\x20font-family:\x20Arial,\x20sans-serif;\x20line-height:\x201.6;\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20.container\x20{\x20max-width:\x20600px;\x20margin:\x200\x20auto;\x20padding:\x2020px;\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20.header\x20{\x20text-align:\x20center;\x20padding:\x2020px;\x20background:\x20#ea580c;\x20color:\x20white;\x20border-radius:\x205px\x205px\x200\x200;\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20.content\x20{\x20padding:\x2020px;\x20background:\x20#f9f9f9;\x20border:\x201px\x20solid\x20#ddd;\x20border-radius:\x200\x200\x205px\x205px;\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20.button\x20{\x20display:\x20inline-block;\x20padding:\x2012px\x2024px;\x20background:\x20#ea580c;\x20color:\x20white\x20!important;\x20text-decoration:\x20none;\x20border-radius:\x205px;\x20margin:\x2020px\x200;\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20.button:hover\x20{\x20background:\x20#f97316;\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20.footer\x20{\x20text-align:\x20center;\x20margin-top:\x2020px;\x20color:\x20#666;\x20font-size:\x2012px;\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20</style>\x0a\x20\x20\x20\x20\x20\x20</head>\x0a\x20\x20\x20\x20\x20\x20<body>\x0a\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22container\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22header\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<h1>Important:\x20Your\x20CADViewer\x20Account</h1>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22content\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<p>Hello\x20','Failed\x20to\x20send\x20email\x20to\x20','./mail.js','Important:\x20Your\x20CADViewer\x20Account\x20Will\x20Expire\x20Soon','\x22\x20class=\x22button\x22>Validate\x20my\x20email\x20address</a>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</p>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<p>If\x20the\x20button\x20doesn\x27t\x20work,\x20you\x20can\x20copy\x20and\x20paste\x20this\x20link\x20in\x20your\x20browser:</p>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<p\x20style=\x22word-break:\x20break-all;\x22>','endsWith','173142ppzYvU','80344qfwsDr','1991848cgoUSn','validation_token','\x0a\x20\x20\x20\x20<!DOCTYPE\x20html>\x0a\x20\x20\x20\x20<html>\x0a\x20\x20\x20\x20\x20\x20<head>\x0a\x20\x20\x20\x20\x20\x20\x20\x20<style>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20body\x20{\x20font-family:\x20Arial,\x20sans-serif;\x20line-height:\x201.6;\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20.container\x20{\x20max-width:\x20600px;\x20margin:\x200\x20auto;\x20padding:\x2020px;\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20.header\x20{\x20text-align:\x20center;\x20padding:\x2020px;\x20background:\x20#ea580c;\x20color:\x20white;\x20border-radius:\x205px\x205px\x200\x200;\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20.content\x20{\x20padding:\x2020px;\x20background:\x20#f9f9f9;\x20border:\x201px\x20solid\x20#ddd;\x20border-radius:\x200\x200\x205px\x205px;\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20.button\x20{\x20display:\x20inline-block;\x20padding:\x2012px\x2024px;\x20background:\x20#ea580c;\x20color:\x20white\x20!important;\x20text-decoration:\x20none;\x20border-radius:\x205px;\x20margin:\x2020px\x200;\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20.button:hover\x20{\x20background:\x20#f97316;\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20.footer\x20{\x20text-align:\x20center;\x20margin-top:\x2020px;\x20color:\x20#666;\x20font-size:\x2012px;\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20</style>\x0a\x20\x20\x20\x20\x20\x20</head>\x0a\x20\x20\x20\x20\x20\x20<body>\x0a\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22container\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22header\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<h1>CADViewer\x20Email\x20Validation\x20Reminder</h1>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22content\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<p>Hello\x20','promise','demoUserRetentionDaysAlertBeforeDeletion','\x0a\x20\x20\x20\x20<!DOCTYPE\x20html>\x0a\x20\x20\x20\x20<html>\x0a\x20\x20\x20\x20\x20\x20<head>\x0a\x20\x20\x20\x20\x20\x20\x20\x20<style>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20body\x20{\x20font-family:\x20Arial,\x20sans-serif;\x20line-height:\x201.6;\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20.container\x20{\x20max-width:\x20600px;\x20margin:\x200\x20auto;\x20padding:\x2020px;\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20.header\x20{\x20text-align:\x20center;\x20padding:\x2020px;\x20background:\x20#ea580c;\x20color:\x20white;\x20border-radius:\x205px\x205px\x200\x200;\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20.content\x20{\x20padding:\x2020px;\x20background:\x20#f9f9f9;\x20border:\x201px\x20solid\x20#ddd;\x20border-radius:\x200\x200\x205px\x205px;\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20.button\x20{\x20display:\x20inline-block;\x20padding:\x2012px\x2024px;\x20background:\x20#ea580c;\x20color:\x20white\x20!important;\x20text-decoration:\x20none;\x20border-radius:\x205px;\x20margin:\x2020px\x200;\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20.button:hover\x20{\x20background:\x20#f97316;\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20.footer\x20{\x20text-align:\x20center;\x20margin-top:\x2020px;\x20color:\x20#666;\x20font-size:\x2012px;\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20</style>\x0a\x20\x20\x20\x20\x20\x20</head>\x0a\x20\x20\x20\x20\x20\x20<body>\x0a\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22container\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22header\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<h1>Welcome\x20to\x20CADViewer!</h1>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22content\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<p>We\x20are\x20delighted\x20to\x20welcome\x20you\x20to\x20our\x20community.</p>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<p>To\x20start\x20using\x20CADViewer\x20Visual\x20Query,\x20please\x20validate\x20your\x20email\x20address\x20by\x20clicking\x20the\x20button\x20below:</p>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<p\x20style=\x22text-align:\x20center;\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<a\x20href=\x22','exports','CADViewer\x20Email\x20Validation\x20Reminder',',</p>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<p>We\x20noticed\x20that\x20you\x20haven\x27t\x20validated\x20your\x20email\x20address\x20yet.\x20It\x27s\x20been\x20','22485456mFOZJB','frontendUrl','username','smtpFrom','email','first_name','UPDATE\x20users\x20SET\x20follow_up_count\x20=\x20follow_up_count\x20+\x201\x20WHERE\x20id\x20=\x20?','Welcome\x20to\x20CADViewer',',</p>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<p>We\x20wanted\x20to\x20inform\x20you\x20that\x20your\x20demo\x20account\x20will\x20expire\x20in\x202\x20days\x20and\x20will\x20be\x20automatically\x20deleted.</p>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<p>If\x20you\x20wish\x20to\x20keep\x20your\x20account\x20and\x20all\x20your\x20data,\x20please\x20contact\x20us\x20on\x20<a\x20href=\x22mailto:developer@tailormade.com\x22>developer@tailormade.com</a>\x20or\x20<a\x20href=\x22mailto:internationalsales@tailormade.com\x22>internationalsales@tailormade.com</a>\x20as\x20soon\x20as\x20possible.</p>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<p>Thank\x20you\x20for\x20using\x20CADViewer!</p>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22footer\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<p>This\x20email\x20was\x20sent\x20automatically,\x20please\x20do\x20not\x20reply.</p>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20</body>\x0a\x20\x20\x20\x20</html>\x0a\x20\x20','sendMail','demoUserRetentionDays','</p>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22footer\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<p>This\x20email\x20was\x20sent\x20automatically,\x20please\x20do\x20not\x20reply.</p>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20</body>\x0a\x20\x20\x20\x20</html>\x0a\x20\x20','execute','\x20since\x20you\x20registered.</p>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<p>To\x20start\x20using\x20CADViewer\x20Visual\x20Query,\x20please\x20validate\x20your\x20email\x20address\x20by\x20clicking\x20the\x20button\x20below:</p>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<p\x20style=\x22text-align:\x20center;\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<a\x20href=\x22'];a3_0xc014=function(){return _0x31af97;};return a3_0xc014();}module[a3_0x54b2ae(0x18a)]={'transporter':transporter,'sendFollowUpEmails':sendFollowUpEmails,'sendAccountDeletionPreventionEmails':sendAccountDeletionPreventionEmails,'sendWelcomeEmail':sendWelcomeEmail};
const a3_0x2c4987=a3_0x33ad;function a3_0x5f21(){const _0x48690=['6\x20hours','validation_token','./mysql.js','12QTDSyV','3746DRTGjy','===================error===================','8UvJULi','93414KsEXYI','11463011rVTOVA','endsWith','execute',',</p>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<p>We\x20wanted\x20to\x20inform\x20you\x20that\x20your\x20demo\x20account\x20will\x20expire\x20in\x202\x20days\x20and\x20will\x20be\x20automatically\x20deleted.</p>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<p>If\x20you\x20wish\x20to\x20keep\x20your\x20account\x20and\x20all\x20your\x20data,\x20please\x20contact\x20us\x20on\x20<a\x20href=\x22mailto:developer@tailormade.com\x22>developer@tailormade.com</a>\x20or\x20<a\x20href=\x22mailto:internationalsales@tailormade.com\x22>internationalsales@tailormade.com</a>\x20as\x20soon\x20as\x20possible.</p>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<p>Thank\x20you\x20for\x20using\x20CADViewer!</p>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22footer\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<p>This\x20email\x20was\x20sent\x20automatically,\x20please\x20do\x20not\x20reply.</p>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20</body>\x0a\x20\x20\x20\x20</html>\x0a\x20\x20','smtpFrom','demoUserRetentionDaysAlertBeforeDeletion','\x0a\x20\x20\x20\x20<!DOCTYPE\x20html>\x0a\x20\x20\x20\x20<html>\x0a\x20\x20\x20\x20\x20\x20<head>\x0a\x20\x20\x20\x20\x20\x20\x20\x20<style>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20body\x20{\x20font-family:\x20Arial,\x20sans-serif;\x20line-height:\x201.6;\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20.container\x20{\x20max-width:\x20600px;\x20margin:\x200\x20auto;\x20padding:\x2020px;\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20.header\x20{\x20text-align:\x20center;\x20padding:\x2020px;\x20background:\x20#ea580c;\x20color:\x20white;\x20border-radius:\x205px\x205px\x200\x200;\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20.content\x20{\x20padding:\x2020px;\x20background:\x20#f9f9f9;\x20border:\x201px\x20solid\x20#ddd;\x20border-radius:\x200\x200\x205px\x205px;\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20.button\x20{\x20display:\x20inline-block;\x20padding:\x2012px\x2024px;\x20background:\x20#ea580c;\x20color:\x20white\x20!important;\x20text-decoration:\x20none;\x20border-radius:\x205px;\x20margin:\x2020px\x200;\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20.button:hover\x20{\x20background:\x20#f97316;\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20.footer\x20{\x20text-align:\x20center;\x20margin-top:\x2020px;\x20color:\x20#666;\x20font-size:\x2012px;\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20</style>\x0a\x20\x20\x20\x20\x20\x20</head>\x0a\x20\x20\x20\x20\x20\x20<body>\x0a\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22container\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22header\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<h1>Welcome\x20to\x20CADViewer!</h1>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22content\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<p>We\x20are\x20delighted\x20to\x20welcome\x20you\x20to\x20our\x20community.</p>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<p>To\x20start\x20using\x20CADViewer\x20Visual\x20Query,\x20please\x20validate\x20your\x20email\x20address\x20by\x20clicking\x20the\x20button\x20below:</p>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<p\x20style=\x22text-align:\x20center;\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<a\x20href=\x22','sendMail','145OJfFuJ','6npvJHB','exports','UPDATE\x20users\x20SET\x20follow_up_count\x20=\x20follow_up_count\x20+\x201\x20WHERE\x20id\x20=\x20?','promise','8139840pfZttw','Important:\x20Your\x20CADViewer\x20Account\x20Will\x20Expire\x20Soon','./mail.js','first_name','SELECT\x20*\x20FROM\x20users\x20WHERE\x20role\x20=\x20\x27demo_user\x27\x20AND\x20created_at\x20<\x20DATE_SUB(NOW(),\x20INTERVAL\x20?\x20DAY)','No\x20users\x20to\x20notify\x20about\x20account\x20deletion','frontendUrl','transporter','746zADoem','../CADViewer_config.json','/validate-email/','Please\x20validate\x20your\x20CADViewer\x20email\x20address','CADViewer\x20Email\x20Validation\x20Reminder','follow_up_count','1074748WOZrGT','</p>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22footer\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<p>This\x20email\x20was\x20sent\x20automatically,\x20please\x20do\x20not\x20reply.</p>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20</body>\x0a\x20\x20\x20\x20</html>\x0a\x20\x20','length','\x22\x20class=\x22button\x22>Validate\x20my\x20email\x20address</a>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</p>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<p>If\x20the\x20button\x20doesn\x27t\x20work,\x20you\x20can\x20copy\x20and\x20paste\x20this\x20link\x20in\x20your\x20browser:</p>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<p\x20style=\x22word-break:\x20break-all;\x22>',',</p>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<p>We\x20noticed\x20that\x20you\x20haven\x27t\x20validated\x20your\x20email\x20address\x20yet.\x20It\x27s\x20been\x20','Welcome\x20to\x20CADViewer','\x0a\x20\x20\x20\x20\x20\x20SELECT\x20*\x0a\x20\x20\x20\x20\x20\x20FROM\x20users\x0a\x20\x20\x20\x20\x20\x20WHERE\x20is_enabled\x20=\x200\x0a\x20\x20\x20\x20\x20\x20AND\x20validation_token\x20IS\x20NOT\x20NULL\x0a\x20\x20\x20\x20\x20\x20AND\x20follow_up_count\x20<\x203\x0a\x20\x20\x20\x20\x20\x20AND\x20created_at\x20<=\x20DATE_SUB(NOW(),\x20INTERVAL\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20CASE\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20WHEN\x20follow_up_count\x20=\x200\x20THEN\x203\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20WHEN\x20follow_up_count\x20=\x201\x20THEN\x206\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20WHEN\x20follow_up_count\x20=\x202\x20THEN\x2012\x0a\x20\x20\x20\x20\x20\x20\x20\x20END\x0a\x20\x20\x20\x20\x20\x20HOUR)\x0a\x20\x20\x20\x20','error','log','Follow-up\x20email\x20sent\x20to\x20','\x0a\x20\x20\x20\x20<!DOCTYPE\x20html>\x0a\x20\x20\x20\x20<html>\x0a\x20\x20\x20\x20\x20\x20<head>\x0a\x20\x20\x20\x20\x20\x20\x20\x20<style>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20body\x20{\x20font-family:\x20Arial,\x20sans-serif;\x20line-height:\x201.6;\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20.container\x20{\x20max-width:\x20600px;\x20margin:\x200\x20auto;\x20padding:\x2020px;\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20.header\x20{\x20text-align:\x20center;\x20padding:\x2020px;\x20background:\x20#ea580c;\x20color:\x20white;\x20border-radius:\x205px\x205px\x200\x200;\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20.content\x20{\x20padding:\x2020px;\x20background:\x20#f9f9f9;\x20border:\x201px\x20solid\x20#ddd;\x20border-radius:\x200\x200\x205px\x205px;\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20.button\x20{\x20display:\x20inline-block;\x20padding:\x2012px\x2024px;\x20background:\x20#ea580c;\x20color:\x20white\x20!important;\x20text-decoration:\x20none;\x20border-radius:\x205px;\x20margin:\x2020px\x200;\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20.button:hover\x20{\x20background:\x20#f97316;\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20.footer\x20{\x20text-align:\x20center;\x20margin-top:\x2020px;\x20color:\x20#666;\x20font-size:\x2012px;\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20</style>\x0a\x20\x20\x20\x20\x20\x20</head>\x0a\x20\x20\x20\x20\x20\x20<body>\x0a\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22container\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22header\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<h1>CADViewer\x20Email\x20Validation\x20Reminder</h1>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22content\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<p>Hello\x20','\x20since\x20you\x20registered.</p>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<p>To\x20start\x20using\x20CADViewer\x20Visual\x20Query,\x20please\x20validate\x20your\x20email\x20address\x20by\x20clicking\x20the\x20button\x20below:</p>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<p\x20style=\x22text-align:\x20center;\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<a\x20href=\x22','14199255RtQzit','slice','email','Error\x20in\x20sendFollowUpEmails:','\x0a\x20\x20\x20\x20<!DOCTYPE\x20html>\x0a\x20\x20\x20\x20<html>\x0a\x20\x20\x20\x20\x20\x20<head>\x0a\x20\x20\x20\x20\x20\x20\x20\x20<style>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20body\x20{\x20font-family:\x20Arial,\x20sans-serif;\x20line-height:\x201.6;\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20.container\x20{\x20max-width:\x20600px;\x20margin:\x200\x20auto;\x20padding:\x2020px;\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20.header\x20{\x20text-align:\x20center;\x20padding:\x2020px;\x20background:\x20#ea580c;\x20color:\x20white;\x20border-radius:\x205px\x205px\x200\x200;\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20.content\x20{\x20padding:\x2020px;\x20background:\x20#f9f9f9;\x20border:\x201px\x20solid\x20#ddd;\x20border-radius:\x200\x200\x205px\x205px;\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20.button\x20{\x20display:\x20inline-block;\x20padding:\x2012px\x2024px;\x20background:\x20#ea580c;\x20color:\x20white\x20!important;\x20text-decoration:\x20none;\x20border-radius:\x205px;\x20margin:\x2020px\x200;\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20.button:hover\x20{\x20background:\x20#f97316;\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20.footer\x20{\x20text-align:\x20center;\x20margin-top:\x2020px;\x20color:\x20#666;\x20font-size:\x2012px;\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20</style>\x0a\x20\x20\x20\x20\x20\x20</head>\x0a\x20\x20\x20\x20\x20\x20<body>\x0a\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22container\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22header\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<h1>Important:\x20Your\x20CADViewer\x20Account</h1>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22content\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<p>Hello\x20','3557257EHVPnE'];a3_0x5f21=function(){return _0x48690;};return a3_0x5f21();}function a3_0x33ad(_0x13ee5a,_0x3a8d9f){const _0x5f217d=a3_0x5f21();return a3_0x33ad=function(_0x33ad1c,_0x39da7f){_0x33ad1c=_0x33ad1c-0x138;let _0x281ae1=_0x5f217d[_0x33ad1c];return _0x281ae1;},a3_0x33ad(_0x13ee5a,_0x3a8d9f);}(function(_0x186c44,_0x105852){const _0x493957=a3_0x33ad,_0x14c867=_0x186c44();while(!![]){try{const _0x4696a2=-parseInt(_0x493957(0x13f))/0x1*(-parseInt(_0x493957(0x158))/0x2)+-parseInt(_0x493957(0x14c))/0x3*(parseInt(_0x493957(0x15e))/0x4)+-parseInt(_0x493957(0x14b))/0x5*(parseInt(_0x493957(0x142))/0x6)+-parseInt(_0x493957(0x143))/0x7+-parseInt(_0x493957(0x141))/0x8*(-parseInt(_0x493957(0x16a))/0x9)+parseInt(_0x493957(0x150))/0xa+-parseInt(_0x493957(0x13a))/0xb*(parseInt(_0x493957(0x13e))/0xc);if(_0x4696a2===_0x105852)break;else _0x14c867['push'](_0x14c867['shift']());}catch(_0x4ce325){_0x14c867['push'](_0x14c867['shift']());}}}(a3_0x5f21,0xccdbe));const config=require(a3_0x2c4987(0x159)),conn=require(a3_0x2c4987(0x13d)),transporter=require(a3_0x2c4987(0x152))[a3_0x2c4987(0x157)],getWelcomeEmailTemplate=(_0x11c48b,_0x2235e9)=>{const _0x36b795=a3_0x2c4987;return _0x36b795(0x149)+_0x2235e9+_0x36b795(0x161)+_0x2235e9+_0x36b795(0x15f);},sendWelcomeEmail=async(_0x5c9153,_0x15b112)=>{const _0x33d103=a3_0x2c4987;try{let _0x52bb94=config[_0x33d103(0x156)];_0x52bb94[_0x33d103(0x144)]('/')&&(_0x52bb94=_0x52bb94[_0x33d103(0x16b)](0x0,-0x1));const _0x1ae511=_0x52bb94+'/validate-email/'+_0x15b112,_0x3c4837=getWelcomeEmailTemplate(_0x5c9153,_0x1ae511),_0x592643={'from':config[_0x33d103(0x147)],'to':_0x5c9153[_0x33d103(0x16c)],'subject':_0x33d103(0x163),'text':_0x33d103(0x163),'html':_0x3c4837};await transporter[_0x33d103(0x14a)](_0x592643),console[_0x33d103(0x166)]('Welcome\x20email\x20sent\x20to\x20'+_0x5c9153[_0x33d103(0x16c)]);}catch(_0x3f4a5b){console[_0x33d103(0x166)]('===================error==================='),console[_0x33d103(0x166)]('Failed\x20to\x20send\x20welcome\x20email\x20to\x20'+_0x5c9153[_0x33d103(0x16c)]+':',_0x3f4a5b);throw _0x3f4a5b;}},getAccountDeletionPreventionTemplate=_0x145972=>{const _0x2a2edb=a3_0x2c4987;return _0x2a2edb(0x139)+(_0x145972[_0x2a2edb(0x153)]||_0x145972['username'])+_0x2a2edb(0x146);},sendAccountDeletionPreventionEmails=async()=>{const _0x12d34b=a3_0x2c4987;try{const [_0x2fb575]=await conn[_0x12d34b(0x14f)]()[_0x12d34b(0x145)](_0x12d34b(0x154),[config['demoUserRetentionDays']-config[_0x12d34b(0x148)]]);if(_0x2fb575[_0x12d34b(0x160)]===0x0){console['log'](_0x12d34b(0x155));return;}for(const _0x3ea05d of _0x2fb575){const _0x2f44e3=getAccountDeletionPreventionTemplate(_0x3ea05d),_0x51076b={'from':config['smtpFrom'],'to':_0x3ea05d[_0x12d34b(0x16c)],'subject':_0x12d34b(0x151),'text':'Your\x20CADViewer\x20demo\x20account\x20will\x20expire\x20in\x202\x20days.\x20Please\x20contact\x20an\x20administrator\x20if\x20you\x20wish\x20to\x20keep\x20your\x20account.','html':_0x2f44e3};try{await transporter['sendMail'](_0x51076b),console[_0x12d34b(0x166)]('Deletion\x20prevention\x20email\x20sent\x20to\x20'+_0x3ea05d['email']);}catch(_0x1291ff){console[_0x12d34b(0x166)](_0x12d34b(0x140)),console[_0x12d34b(0x166)]('Failed\x20to\x20send\x20email\x20to\x20'+_0x3ea05d[_0x12d34b(0x16c)]),console[_0x12d34b(0x166)](_0x1291ff);}}}catch(_0x18c1a9){console[_0x12d34b(0x166)](_0x12d34b(0x140)),console[_0x12d34b(0x166)]('Error\x20while\x20fetching\x20users\x20for\x20account\x20deletion\x20prevention\x20emails'),console[_0x12d34b(0x166)](_0x18c1a9);}},getFollowUpEmailTemplate=(_0x37eb48,_0x26d10c,_0x1a01b2)=>{const _0x56d7b5=a3_0x2c4987,_0x4f110e={0x1:'3\x20hours',0x2:_0x56d7b5(0x13b),0x3:'12\x20hours'}[_0x1a01b2];return _0x56d7b5(0x168)+(_0x37eb48[_0x56d7b5(0x153)]||_0x37eb48['username'])+_0x56d7b5(0x162)+_0x4f110e+_0x56d7b5(0x169)+_0x26d10c+_0x56d7b5(0x161)+_0x26d10c+_0x56d7b5(0x15f);},sendFollowUpEmails=async()=>{const _0x547f8f=a3_0x2c4987;try{const _0x4a51c4=_0x547f8f(0x164),[_0x2915e5]=await conn[_0x547f8f(0x14f)]()[_0x547f8f(0x145)](_0x4a51c4);for(const _0x27823e of _0x2915e5){const _0x5925d6=config[_0x547f8f(0x156)]+_0x547f8f(0x15a)+_0x27823e[_0x547f8f(0x13c)],_0x5ab880=getFollowUpEmailTemplate(_0x27823e,_0x5925d6,_0x27823e[_0x547f8f(0x15d)]+0x1),_0x37839a={'from':config['smtpFrom'],'to':_0x27823e[_0x547f8f(0x16c)],'subject':_0x547f8f(0x15c),'text':_0x547f8f(0x15b),'html':_0x5ab880};try{await transporter[_0x547f8f(0x14a)](_0x37839a),await conn[_0x547f8f(0x14f)]()['execute'](_0x547f8f(0x14e),[_0x27823e['id']]),console[_0x547f8f(0x166)](_0x547f8f(0x167)+_0x27823e[_0x547f8f(0x16c)]);}catch(_0xe92e69){console[_0x547f8f(0x165)]('Failed\x20to\x20send\x20follow-up\x20email\x20to\x20'+_0x27823e[_0x547f8f(0x16c)]+':',_0xe92e69);}}}catch(_0x1509fd){console[_0x547f8f(0x165)](_0x547f8f(0x138),_0x1509fd);}};module[a3_0x2c4987(0x14d)]={'transporter':transporter,'sendFollowUpEmails':sendFollowUpEmails,'sendAccountDeletionPreventionEmails':sendAccountDeletionPreventionEmails,'sendWelcomeEmail':sendWelcomeEmail};
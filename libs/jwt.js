const a4_0x1e56ac=a4_0x3c2e;function a4_0x3c2e(_0xa30ee8,_0x5c05df){const _0x321d31=a4_0x321d();return a4_0x3c2e=function(_0x3c2eee,_0x185613){_0x3c2eee=_0x3c2eee-0x198;let _0x417123=_0x321d31[_0x3c2eee];return _0x417123;},a4_0x3c2e(_0xa30ee8,_0x5c05df);}function a4_0x321d(){const _0x24e928=['12858deANOO','status','split','3VIPsBA','authorization','10cfEFrB','134852AFsqte','exports','user','json','4563482iobfyD','677409SukEXY','../CADViewer_config.json','headers','49PFyRet','Invalid\x20token','1153000nTkubr','verify','jwtSecretKey','455fkHmIr','381704yUXvBc','2785356NTeRdG'];a4_0x321d=function(){return _0x24e928;};return a4_0x321d();}(function(_0x120b57,_0x2007e7){const _0x5d6b0d=a4_0x3c2e,_0x2566aa=_0x120b57();while(!![]){try{const _0x129a7a=parseInt(_0x5d6b0d(0x199))/0x1*(parseInt(_0x5d6b0d(0x19c))/0x2)+parseInt(_0x5d6b0d(0x1a1))/0x3+-parseInt(_0x5d6b0d(0x1a6))/0x4+-parseInt(_0x5d6b0d(0x1a9))/0x5*(parseInt(_0x5d6b0d(0x1ac))/0x6)+-parseInt(_0x5d6b0d(0x1a4))/0x7*(-parseInt(_0x5d6b0d(0x1aa))/0x8)+parseInt(_0x5d6b0d(0x1ab))/0x9+-parseInt(_0x5d6b0d(0x19b))/0xa*(parseInt(_0x5d6b0d(0x1a0))/0xb);if(_0x129a7a===_0x2007e7)break;else _0x2566aa['push'](_0x2566aa['shift']());}catch(_0x21c070){_0x2566aa['push'](_0x2566aa['shift']());}}}(a4_0x321d,0x2a577));const jwt=require('jsonwebtoken'),config=require(a4_0x1e56ac(0x1a2)),verifyToken=(_0x307a12,_0xacbd90,_0x17766a)=>{const _0x1882d7=a4_0x1e56ac,_0x2abe0f=_0x307a12['headers'][_0x1882d7(0x19a)],_0x124d6f=_0x2abe0f&&_0x2abe0f[_0x1882d7(0x198)]('\x20')[0x1];if(!_0x124d6f)return _0xacbd90[_0x1882d7(0x1ad)](0x191)[_0x1882d7(0x19f)]({'error':'Access\x20denied.\x20No\x20token\x20provided'});try{const _0x276ca9=jwt['verify'](_0x124d6f,config[_0x1882d7(0x1a8)]);_0x307a12['user']=_0x276ca9,_0x17766a();}catch(_0x2ee9d2){_0xacbd90[_0x1882d7(0x1ad)](0x190)['json']({'error':_0x1882d7(0x1a5)});}},verifyTokenOptional=(_0x489c91,_0x9949b2,_0x4d58af)=>{const _0x39ab30=a4_0x1e56ac,_0x27abb5=_0x489c91[_0x39ab30(0x1a3)]['authorization'],_0x4e5419=_0x27abb5&&_0x27abb5['split']('\x20')[0x1];if(!_0x4e5419){_0x4d58af();return;}try{const _0x34bdee=jwt[_0x39ab30(0x1a7)](_0x4e5419,config[_0x39ab30(0x1a8)]);_0x489c91[_0x39ab30(0x19e)]=_0x34bdee,_0x4d58af();}catch(_0x3a5c59){_0x9949b2[_0x39ab30(0x1ad)](0x190)['json']({'error':_0x39ab30(0x1a5)});}};module[a4_0x1e56ac(0x19d)]={'verifyToken':verifyToken,'verifyTokenOptional':verifyTokenOptional};
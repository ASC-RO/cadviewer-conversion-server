const a2_0x1465c7=a2_0x2a91;function a2_0x1e14(){const _0x189c9b=['inputMb','log','timestamp','Error\x20saving\x20monitoring\x20data:','info','end','length','now','filter','usedMemMb','14203112HbWFsL','currentRequests','padStart','httpCodesStoragePath','includes','method','netstat','byCodes','Error\x20getting\x20CPU\x20usage:','middleware','getMinutes','apply','startPeriodicSave','forEach','lastMinute','memory','=======>','mem','then','path','ressourcesUsageStatsPath','httpCodesData','141taWfvx','usage','readFile','getHours','cadviewer/settings/requests-per-minute.json','writeFile','total','statusCode','network','cadviewer/settings/ressources-usage-stats.json','423LGCEYP','6576563SHrKis','cpu','15sMhayn','error','getStats','154060OnCywZ','time','54187562JVWvtF','30882bZmqtW','rpsStoragePath','node-os-utils','ressourcesUsageStats','/metrics','outputMb','Request\x20monitor\x20middleware','parse','slice','save','byPath','utf8','codes','floor','Request\x20monitor\x20initialized.','2ttTJBe','335710ESxuYe','getUsageRessourcesStatsAndSave','Error\x20getting\x20memory\x20usage:','stringify','toFixed','exports','promises','push','rpsData','1635566jxgvrm','cadviewer/settings/http-codes-24h.json'];a2_0x1e14=function(){return _0x189c9b;};return a2_0x1e14();}(function(_0x57deb1,_0xc3518b){const _0x30b6ce=a2_0x2a91,_0x15da7b=_0x57deb1();while(!![]){try{const _0x351bad=-parseInt(_0x30b6ce(0x213))/0x1*(-parseInt(_0x30b6ce(0x21d))/0x2)+-parseInt(_0x30b6ce(0x1f1))/0x3*(-parseInt(_0x30b6ce(0x201))/0x4)+-parseInt(_0x30b6ce(0x1fe))/0x5*(-parseInt(_0x30b6ce(0x204))/0x6)+-parseInt(_0x30b6ce(0x1fc))/0x7+parseInt(_0x30b6ce(0x229))/0x8+parseInt(_0x30b6ce(0x1fb))/0x9*(parseInt(_0x30b6ce(0x214))/0xa)+-parseInt(_0x30b6ce(0x203))/0xb;if(_0x351bad===_0xc3518b)break;else _0x15da7b['push'](_0x15da7b['shift']());}catch(_0x5e6c28){_0x15da7b['push'](_0x15da7b['shift']());}}}(a2_0x1e14,0xe7a33));const fs=require('fs')[a2_0x1465c7(0x21a)],osu=require(a2_0x1465c7(0x206));class RequestMonitor{static [a2_0x1465c7(0x205)]=a2_0x1465c7(0x1f5);static [a2_0x1465c7(0x22c)]=a2_0x1465c7(0x21e);static ['ressourcesUsageStatsPath']=a2_0x1465c7(0x1fa);static [a2_0x1465c7(0x21c)]=[];static [a2_0x1465c7(0x1f0)]=[];static [a2_0x1465c7(0x207)]={};static [a2_0x1465c7(0x1e9)]=Math[a2_0x1465c7(0x211)](Date[a2_0x1465c7(0x226)]()/0x3e8/0x3c);static [a2_0x1465c7(0x22a)]=0x0;static async['init'](){const _0x2d415b=a2_0x1465c7;console[_0x2d415b(0x220)]('Initializing\x20request\x20monitor...');try{const _0x1fc905=await fs[_0x2d415b(0x1f3)](RequestMonitor[_0x2d415b(0x205)],_0x2d415b(0x20f));RequestMonitor[_0x2d415b(0x21c)]=JSON[_0x2d415b(0x20b)](_0x1fc905);}catch(_0x46d12c){RequestMonitor[_0x2d415b(0x21c)]=[];}try{const _0x516414=await fs[_0x2d415b(0x1f3)](RequestMonitor['httpCodesStoragePath'],_0x2d415b(0x20f));RequestMonitor[_0x2d415b(0x1f0)]=JSON[_0x2d415b(0x20b)](_0x516414);}catch(_0x500796){RequestMonitor['httpCodesData']=[];}try{const _0x26564f=await fs['readFile'](RequestMonitor[_0x2d415b(0x1ef)],_0x2d415b(0x20f));RequestMonitor[_0x2d415b(0x207)]=JSON[_0x2d415b(0x20b)](_0x26564f),!RequestMonitor[_0x2d415b(0x207)][_0x2d415b(0x1fd)]&&(RequestMonitor[_0x2d415b(0x207)][_0x2d415b(0x1fd)]=[]),!RequestMonitor[_0x2d415b(0x207)][_0x2d415b(0x1ea)]&&(RequestMonitor['ressourcesUsageStats']['memory']=[]),!RequestMonitor[_0x2d415b(0x207)][_0x2d415b(0x1f9)]&&(RequestMonitor['ressourcesUsageStats'][_0x2d415b(0x1f9)]=[]);}catch(_0x2405f1){RequestMonitor[_0x2d415b(0x207)]={'cpu':[],'memory':[],'network':[]};}console[_0x2d415b(0x220)](_0x2d415b(0x212));}static[a2_0x1465c7(0x232)](_0x2e0e79,_0x1e88d7,_0x6e3d05){const _0x1c0c96=a2_0x1465c7;if(_0x2e0e79[_0x1c0c96(0x1ee)][_0x1c0c96(0x22d)](_0x1c0c96(0x208)))return _0x6e3d05();console[_0x1c0c96(0x220)](_0x1c0c96(0x20a));let _0x500a9a=Date['now'](),_0x2889cd=Math[_0x1c0c96(0x211)](_0x500a9a/0x3e8/0x3c);console[_0x1c0c96(0x220)](_0x1c0c96(0x1eb));const _0x26be6b=_0x1e88d7['end'];_0x1e88d7[_0x1c0c96(0x224)]=(..._0x39f4c9)=>{const _0x39178e=_0x1c0c96;console[_0x39178e(0x220)](_0x2889cd,{'currentMinute':_0x2889cd});_0x2889cd>RequestMonitor[_0x39178e(0x1e9)]&&(RequestMonitor[_0x39178e(0x21c)]['push']({'timestamp':RequestMonitor['lastMinute']*0x3e8*0x3c,'requests':RequestMonitor[_0x39178e(0x22a)]}),RequestMonitor[_0x39178e(0x22a)]=0x0,RequestMonitor[_0x39178e(0x1e9)]=_0x2889cd);RequestMonitor[_0x39178e(0x22a)]++,RequestMonitor[_0x39178e(0x1f0)][_0x39178e(0x21b)]({'timestamp':Date[_0x39178e(0x226)](),'statusCode':_0x1e88d7[_0x39178e(0x1f8)],'path':_0x2e0e79[_0x39178e(0x1ee)],'method':_0x2e0e79[_0x39178e(0x22e)]});const _0x4dfe8d=Date[_0x39178e(0x226)]()-0x18*0x3c*0x3c*0x3e8;return RequestMonitor[_0x39178e(0x1f0)]=RequestMonitor[_0x39178e(0x1f0)][_0x39178e(0x227)](_0x4b1237=>_0x4b1237[_0x39178e(0x221)]>_0x4dfe8d),_0x26be6b[_0x39178e(0x234)](_0x1e88d7,_0x39f4c9);},_0x6e3d05();}static async[a2_0x1465c7(0x20d)](){const _0x42c98c=a2_0x1465c7;try{RequestMonitor[_0x42c98c(0x1e9)]!==Math[_0x42c98c(0x211)](Date[_0x42c98c(0x226)]()/0x3e8/0x3c)&&(RequestMonitor[_0x42c98c(0x21c)][_0x42c98c(0x21b)]({'timestamp':RequestMonitor[_0x42c98c(0x1e9)]*0x3e8*0x3c,'requests':RequestMonitor[_0x42c98c(0x22a)]}),RequestMonitor[_0x42c98c(0x22a)]=0x0,RequestMonitor[_0x42c98c(0x1e9)]=Math['floor'](Date[_0x42c98c(0x226)]()/0x3e8/0x3c)),await fs[_0x42c98c(0x1f6)](RequestMonitor[_0x42c98c(0x205)],JSON[_0x42c98c(0x217)](RequestMonitor[_0x42c98c(0x21c)],null,0x2)),await fs[_0x42c98c(0x1f6)](RequestMonitor[_0x42c98c(0x22c)],JSON['stringify'](RequestMonitor[_0x42c98c(0x1f0)],null,0x2));}catch(_0x29ae51){console[_0x42c98c(0x1ff)](_0x42c98c(0x222),_0x29ae51);}}static async[a2_0x1465c7(0x235)](){const _0x13b590=a2_0x1465c7;setInterval(()=>RequestMonitor['save'](),0x3c*0x3e8),setInterval(()=>{const _0x5ec2d7=a2_0x2a91;RequestMonitor['getUsageRessourcesStatsAndSave']()[_0x5ec2d7(0x1ed)](()=>{});},0x3c*0x3e8),RequestMonitor[_0x13b590(0x215)]()[_0x13b590(0x1ed)](()=>{});}static async['getUsageRessourcesStatsAndSave'](){const _0x1b42ee=a2_0x1465c7,_0x2a1c32=osu[_0x1b42ee(0x1fd)],_0x478a31=osu[_0x1b42ee(0x1ec)],_0x433108=osu[_0x1b42ee(0x22f)],_0x2d52a9={'total':{'inputMb':0x0,'outputMb':0x0}};try{const _0x2bb87e=await _0x433108['inOut']();_0x2d52a9[_0x1b42ee(0x1f7)][_0x1b42ee(0x21f)]=_0x2bb87e[_0x1b42ee(0x1f7)][_0x1b42ee(0x21f)],_0x2d52a9[_0x1b42ee(0x1f7)][_0x1b42ee(0x209)]=_0x2bb87e[_0x1b42ee(0x1f7)]['outputMb'];}catch(_0xdc8536){}let _0x10c972=0x0;try{_0x10c972=await _0x2a1c32[_0x1b42ee(0x1f2)]();}catch(_0x51485a){console[_0x1b42ee(0x220)](_0x1b42ee(0x231),_0x51485a);}const _0x30fadc={'usedMemMb':0x0};try{const _0x4e2f8f=await _0x478a31[_0x1b42ee(0x223)]();_0x30fadc[_0x1b42ee(0x228)]=_0x4e2f8f['usedMemMb'];}catch(_0x2916b7){console[_0x1b42ee(0x220)](_0x1b42ee(0x216),_0x2916b7);}const _0x1a680a=new Date()[_0x1b42ee(0x1f4)]()['toString']()[_0x1b42ee(0x22b)](0x2,'0')+':'+new Date()[_0x1b42ee(0x233)]()['toString']()[_0x1b42ee(0x22b)](0x2,'0');RequestMonitor['ressourcesUsageStats'][_0x1b42ee(0x1fd)]=RequestMonitor[_0x1b42ee(0x207)]['cpu']['slice'](-0x3c)[_0x1b42ee(0x227)](_0x31e31c=>_0x31e31c[_0x1b42ee(0x202)]!==_0x1a680a),RequestMonitor['ressourcesUsageStats'][_0x1b42ee(0x1ea)]=RequestMonitor[_0x1b42ee(0x207)]['memory']['slice'](-0x3c)['filter'](_0x120e29=>_0x120e29[_0x1b42ee(0x202)]!==_0x1a680a),RequestMonitor[_0x1b42ee(0x207)]['network']=RequestMonitor[_0x1b42ee(0x207)]['network'][_0x1b42ee(0x20c)](-0x3c)[_0x1b42ee(0x227)](_0x34ba2e=>_0x34ba2e[_0x1b42ee(0x202)]!==_0x1a680a),RequestMonitor['ressourcesUsageStats'][_0x1b42ee(0x1fd)]['push']({'time':_0x1a680a,'usage':_0x10c972}),RequestMonitor[_0x1b42ee(0x207)][_0x1b42ee(0x1ea)][_0x1b42ee(0x21b)]({'time':_0x1a680a,'usage':(_0x30fadc['usedMemMb']/0x3e8)[_0x1b42ee(0x218)](0x2)}),RequestMonitor[_0x1b42ee(0x207)][_0x1b42ee(0x1f9)][_0x1b42ee(0x21b)]({'time':_0x1a680a,'usage':{'in':_0x2d52a9['total']?.['inputMb']??0x0,'out':_0x2d52a9[_0x1b42ee(0x1f7)]?.['outputMb']??0x0}});try{await fs[_0x1b42ee(0x1f6)](RequestMonitor[_0x1b42ee(0x1ef)],JSON[_0x1b42ee(0x217)](RequestMonitor[_0x1b42ee(0x207)],null,0x2));}catch(_0x572431){console[_0x1b42ee(0x1ff)](_0x1b42ee(0x222),_0x572431);}}static[a2_0x1465c7(0x200)](){const _0x35be55=a2_0x1465c7,_0x48c06f=Date[_0x35be55(0x226)](),_0x11fbc8=_0x48c06f-0x3c*0x3c*0x3e8,_0xe12b88=_0x48c06f-0x18*0x3c*0x3c*0x3e8,_0x57381d=RequestMonitor[_0x35be55(0x21c)][_0x35be55(0x227)](_0x35e6b0=>_0x35e6b0[_0x35be55(0x221)]>_0x11fbc8),_0x3ca6f9={'total':RequestMonitor[_0x35be55(0x1f0)][_0x35be55(0x225)],'byCodes':{},'byPath':{}};return RequestMonitor[_0x35be55(0x1f0)][_0x35be55(0x1e8)](_0xac549a=>{const _0x3c928a=_0x35be55;_0x3ca6f9[_0x3c928a(0x230)][_0xac549a[_0x3c928a(0x1f8)]]=(_0x3ca6f9['byCodes'][_0xac549a[_0x3c928a(0x1f8)]]||0x0)+0x1;const _0x4638cd=_0xac549a['method']+'\x20'+_0xac549a[_0x3c928a(0x1ee)];!_0x3ca6f9[_0x3c928a(0x20e)][_0x4638cd]&&(_0x3ca6f9[_0x3c928a(0x20e)][_0x4638cd]={'total':0x0,'codes':{}}),_0x3ca6f9['byPath'][_0x4638cd][_0x3c928a(0x1f7)]++,_0x3ca6f9[_0x3c928a(0x20e)][_0x4638cd][_0x3c928a(0x210)][_0xac549a[_0x3c928a(0x1f8)]]=(_0x3ca6f9[_0x3c928a(0x20e)][_0x4638cd]['codes'][_0xac549a[_0x3c928a(0x1f8)]]||0x0)+0x1;}),{'rps':_0x57381d,'httpCodes':_0x3ca6f9,'ressourcesUsageStats':RequestMonitor['ressourcesUsageStats']};}}RequestMonitor['init']()[a2_0x1465c7(0x1ed)](()=>{}),RequestMonitor[a2_0x1465c7(0x235)]();function a2_0x2a91(_0x4eae22,_0x49993c){const _0x1e14c7=a2_0x1e14();return a2_0x2a91=function(_0x2a91d1,_0x3806c6){_0x2a91d1=_0x2a91d1-0x1e8;let _0xe49b3b=_0x1e14c7[_0x2a91d1];return _0xe49b3b;},a2_0x2a91(_0x4eae22,_0x49993c);}const counter=RequestMonitor;module[a2_0x1465c7(0x219)]=counter;
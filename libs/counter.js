function a2_0x22f1(_0x5c7e82,_0x5c8d2e){const _0x128bcf=a2_0x128b();return a2_0x22f1=function(_0x22f18b,_0x59fd56){_0x22f18b=_0x22f18b-0x185;let _0x18254c=_0x128bcf[_0x22f18b];return _0x18254c;},a2_0x22f1(_0x5c7e82,_0x5c8d2e);}const a2_0x4532e7=a2_0x22f1;(function(_0x2262e6,_0x4c9105){const _0x348f34=a2_0x22f1,_0xe2f78e=_0x2262e6();while(!![]){try{const _0x15794c=parseInt(_0x348f34(0x192))/0x1*(-parseInt(_0x348f34(0x1a8))/0x2)+parseInt(_0x348f34(0x187))/0x3+parseInt(_0x348f34(0x18c))/0x4+-parseInt(_0x348f34(0x1c4))/0x5+parseInt(_0x348f34(0x1ac))/0x6+parseInt(_0x348f34(0x1bf))/0x7+-parseInt(_0x348f34(0x1b0))/0x8*(-parseInt(_0x348f34(0x197))/0x9);if(_0x15794c===_0x4c9105)break;else _0xe2f78e['push'](_0xe2f78e['shift']());}catch(_0x20a9f2){_0xe2f78e['push'](_0xe2f78e['shift']());}}}(a2_0x128b,0xbf93b));const fs=require('fs')[a2_0x4532e7(0x1a2)],osu=require(a2_0x4532e7(0x195));class RequestMonitor{static ['rpsStoragePath']=a2_0x4532e7(0x18b);static [a2_0x4532e7(0x1b7)]=a2_0x4532e7(0x190);static [a2_0x4532e7(0x1c0)]=a2_0x4532e7(0x1bb);static [a2_0x4532e7(0x19b)]=[];static ['httpCodesData']=[];static [a2_0x4532e7(0x1a7)]={};static [a2_0x4532e7(0x1b4)]=Math[a2_0x4532e7(0x1b1)](Date[a2_0x4532e7(0x191)]()/0x3e8/0x3c);static [a2_0x4532e7(0x1af)]=0x0;static async[a2_0x4532e7(0x1cd)](){const _0xbce83=a2_0x4532e7;console['log'](_0xbce83(0x194));try{const _0x4a244a=await fs[_0xbce83(0x1ba)](RequestMonitor[_0xbce83(0x1c5)],_0xbce83(0x1ad));RequestMonitor[_0xbce83(0x19b)]=JSON[_0xbce83(0x1c1)](_0x4a244a);}catch(_0x397b20){RequestMonitor[_0xbce83(0x19b)]=[];}try{const _0x3528e2=await fs[_0xbce83(0x1ba)](RequestMonitor[_0xbce83(0x1b7)],'utf8');RequestMonitor[_0xbce83(0x18a)]=JSON[_0xbce83(0x1c1)](_0x3528e2);}catch(_0x447d97){RequestMonitor['httpCodesData']=[];}try{const _0x4a2c25=await fs[_0xbce83(0x1ba)](RequestMonitor[_0xbce83(0x1c0)],_0xbce83(0x1ad));RequestMonitor[_0xbce83(0x1a7)]=JSON['parse'](_0x4a2c25),!RequestMonitor[_0xbce83(0x1a7)][_0xbce83(0x19c)]&&(RequestMonitor['ressourcesUsageStats'][_0xbce83(0x19c)]=[]),!RequestMonitor[_0xbce83(0x1a7)][_0xbce83(0x1cc)]&&(RequestMonitor[_0xbce83(0x1a7)]['memory']=[]),!RequestMonitor[_0xbce83(0x1a7)][_0xbce83(0x1a5)]&&(RequestMonitor['ressourcesUsageStats'][_0xbce83(0x1a5)]=[]);}catch(_0x2242bc){RequestMonitor[_0xbce83(0x1a7)]={'cpu':[],'memory':[],'network':[]};}console[_0xbce83(0x1c3)](_0xbce83(0x1c2));}static[a2_0x4532e7(0x1be)](_0x435d5f,_0x2d8e64,_0x9b53ff){const _0x278458=a2_0x4532e7;if(_0x435d5f[_0x278458(0x18d)][_0x278458(0x1c7)]('/metrics'))return _0x9b53ff();console[_0x278458(0x1c3)](_0x278458(0x1a9));let _0x620372=Date['now'](),_0x2131cf=Math[_0x278458(0x1b1)](_0x620372/0x3e8/0x3c);console[_0x278458(0x1c3)](_0x278458(0x189));const _0x1b03e4=_0x2d8e64['end'];_0x2d8e64[_0x278458(0x198)]=(..._0x53fb2c)=>{const _0x41d8fc=_0x278458;console[_0x41d8fc(0x1c3)](_0x2131cf,{'currentMinute':_0x2131cf});_0x2131cf>RequestMonitor[_0x41d8fc(0x1b4)]&&(RequestMonitor[_0x41d8fc(0x19b)]['push']({'timestamp':RequestMonitor[_0x41d8fc(0x1b4)]*0x3e8*0x3c,'requests':RequestMonitor['currentRequests']}),RequestMonitor['currentRequests']=0x0,RequestMonitor[_0x41d8fc(0x1b4)]=_0x2131cf);RequestMonitor[_0x41d8fc(0x1af)]++,RequestMonitor[_0x41d8fc(0x18a)]['push']({'timestamp':Date[_0x41d8fc(0x191)](),'statusCode':_0x2d8e64[_0x41d8fc(0x19d)],'path':_0x435d5f[_0x41d8fc(0x18d)],'method':_0x435d5f[_0x41d8fc(0x1b9)]});const _0x29f822=Date[_0x41d8fc(0x191)]()-0x18*0x3c*0x3c*0x3e8;return RequestMonitor[_0x41d8fc(0x18a)]=RequestMonitor[_0x41d8fc(0x18a)][_0x41d8fc(0x186)](_0x3bfa1d=>_0x3bfa1d[_0x41d8fc(0x1a6)]>_0x29f822),_0x1b03e4[_0x41d8fc(0x196)](_0x2d8e64,_0x53fb2c);},_0x9b53ff();}static async[a2_0x4532e7(0x188)](){const _0x5f265c=a2_0x4532e7;try{RequestMonitor['lastMinute']!==Math[_0x5f265c(0x1b1)](Date[_0x5f265c(0x191)]()/0x3e8/0x3c)&&(RequestMonitor[_0x5f265c(0x19b)]['push']({'timestamp':RequestMonitor[_0x5f265c(0x1b4)]*0x3e8*0x3c,'requests':RequestMonitor['currentRequests']}),RequestMonitor[_0x5f265c(0x1af)]=0x0,RequestMonitor[_0x5f265c(0x1b4)]=Math[_0x5f265c(0x1b1)](Date[_0x5f265c(0x191)]()/0x3e8/0x3c)),await fs[_0x5f265c(0x199)](RequestMonitor[_0x5f265c(0x1c5)],JSON[_0x5f265c(0x1c6)](RequestMonitor[_0x5f265c(0x19b)],null,0x2)),await fs['writeFile'](RequestMonitor[_0x5f265c(0x1b7)],JSON[_0x5f265c(0x1c6)](RequestMonitor['httpCodesData'],null,0x2));}catch(_0x172adc){console[_0x5f265c(0x1c8)]('Error\x20saving\x20monitoring\x20data:',_0x172adc);}}static async[a2_0x4532e7(0x1a4)](){setInterval(()=>RequestMonitor['save'](),0x3c*0x3e8),setInterval(()=>{const _0x1f1c28=a2_0x22f1;RequestMonitor[_0x1f1c28(0x1b6)]()['then'](()=>{});},0x3c*0x3e8),RequestMonitor['getUsageRessourcesStatsAndSave']()['then'](()=>{});}static async[a2_0x4532e7(0x1b6)](){const _0x58e5b0=a2_0x4532e7,_0x138740=osu[_0x58e5b0(0x19c)],_0x50b91b=osu['mem'],_0x59a6f0=osu[_0x58e5b0(0x18e)],_0x54c454={'total':{'inputMb':0x0,'outputMb':0x0}};try{const _0x155954=await _0x59a6f0['inOut']();_0x54c454[_0x58e5b0(0x1ae)][_0x58e5b0(0x19e)]=_0x155954[_0x58e5b0(0x1ae)][_0x58e5b0(0x19e)],_0x54c454['total'][_0x58e5b0(0x18f)]=_0x155954[_0x58e5b0(0x1ae)][_0x58e5b0(0x18f)];}catch(_0x29ab57){}let _0x23aacc=0x0;try{_0x23aacc=await _0x138740[_0x58e5b0(0x19a)]();}catch(_0x301c62){console[_0x58e5b0(0x1c3)](_0x58e5b0(0x1b8),_0x301c62);}const _0x307427={'usedMemMb':0x0};try{const _0x4b146e=await _0x50b91b[_0x58e5b0(0x1b5)]();_0x307427[_0x58e5b0(0x1aa)]=_0x4b146e['usedMemMb'];}catch(_0x85aa4d){console[_0x58e5b0(0x1c3)](_0x58e5b0(0x1bd),_0x85aa4d);}const _0x13595d=new Date()[_0x58e5b0(0x1ab)]()[_0x58e5b0(0x1cb)]()[_0x58e5b0(0x1ca)](0x2,'0')+':'+new Date()[_0x58e5b0(0x1b2)]()['toString']()['padStart'](0x2,'0');RequestMonitor[_0x58e5b0(0x1a7)][_0x58e5b0(0x19c)]=RequestMonitor[_0x58e5b0(0x1a7)][_0x58e5b0(0x19c)][_0x58e5b0(0x193)](-0x3c)[_0x58e5b0(0x186)](_0x464a2c=>_0x464a2c[_0x58e5b0(0x1a3)]!==_0x13595d),RequestMonitor[_0x58e5b0(0x1a7)][_0x58e5b0(0x1cc)]=RequestMonitor[_0x58e5b0(0x1a7)][_0x58e5b0(0x1cc)][_0x58e5b0(0x193)](-0x3c)[_0x58e5b0(0x186)](_0xbab2e3=>_0xbab2e3[_0x58e5b0(0x1a3)]!==_0x13595d),RequestMonitor[_0x58e5b0(0x1a7)][_0x58e5b0(0x1a5)]=RequestMonitor[_0x58e5b0(0x1a7)][_0x58e5b0(0x1a5)][_0x58e5b0(0x193)](-0x3c)['filter'](_0xd2cbac=>_0xd2cbac[_0x58e5b0(0x1a3)]!==_0x13595d),RequestMonitor['ressourcesUsageStats'][_0x58e5b0(0x19c)][_0x58e5b0(0x1bc)]({'time':_0x13595d,'usage':_0x23aacc}),RequestMonitor['ressourcesUsageStats'][_0x58e5b0(0x1cc)][_0x58e5b0(0x1bc)]({'time':_0x13595d,'usage':(_0x307427['usedMemMb']/0x3e8)['toFixed'](0x2)}),RequestMonitor[_0x58e5b0(0x1a7)][_0x58e5b0(0x1a5)]['push']({'time':_0x13595d,'usage':{'in':_0x54c454[_0x58e5b0(0x1ae)]?.['inputMb']??0x0,'out':_0x54c454[_0x58e5b0(0x1ae)]?.['outputMb']??0x0}});try{await fs[_0x58e5b0(0x199)](RequestMonitor[_0x58e5b0(0x1c0)],JSON[_0x58e5b0(0x1c6)](RequestMonitor[_0x58e5b0(0x1a7)],null,0x2));}catch(_0x35775c){console[_0x58e5b0(0x1c8)](_0x58e5b0(0x19f),_0x35775c);}}static['getStats'](){const _0x46ee60=a2_0x4532e7,_0x10c892=Date['now'](),_0x3fae18=_0x10c892-0x3c*0x3c*0x3e8,_0x1dc2cd=_0x10c892-0x18*0x3c*0x3c*0x3e8,_0x3c8a18=RequestMonitor[_0x46ee60(0x19b)]['filter'](_0x3043c4=>_0x3043c4[_0x46ee60(0x1a6)]>_0x3fae18),_0x24d09b={'total':RequestMonitor[_0x46ee60(0x18a)]['length'],'byCodes':{},'byPath':{}};return RequestMonitor[_0x46ee60(0x18a)][_0x46ee60(0x185)](_0x653e24=>{const _0x3b282b=_0x46ee60;_0x24d09b['byCodes'][_0x653e24[_0x3b282b(0x19d)]]=(_0x24d09b[_0x3b282b(0x1a0)][_0x653e24[_0x3b282b(0x19d)]]||0x0)+0x1;const _0x4ce511=_0x653e24['method']+'\x20'+_0x653e24[_0x3b282b(0x18d)];!_0x24d09b[_0x3b282b(0x1c9)][_0x4ce511]&&(_0x24d09b['byPath'][_0x4ce511]={'total':0x0,'codes':{}}),_0x24d09b[_0x3b282b(0x1c9)][_0x4ce511]['total']++,_0x24d09b[_0x3b282b(0x1c9)][_0x4ce511][_0x3b282b(0x1a1)][_0x653e24[_0x3b282b(0x19d)]]=(_0x24d09b[_0x3b282b(0x1c9)][_0x4ce511]['codes'][_0x653e24[_0x3b282b(0x19d)]]||0x0)+0x1;}),{'rps':_0x3c8a18,'httpCodes':_0x24d09b,'ressourcesUsageStats':RequestMonitor['ressourcesUsageStats']};}}RequestMonitor['init']()[a2_0x4532e7(0x1b3)](()=>{}),RequestMonitor['startPeriodicSave']();const counter=RequestMonitor;module['exports']=counter;function a2_0x128b(){const _0x2d8beb=['codes','promises','time','startPeriodicSave','network','timestamp','ressourcesUsageStats','20gnQYpr','Request\x20monitor\x20middleware','usedMemMb','getHours','2538708sABIhr','utf8','total','currentRequests','1216kdwoYF','floor','getMinutes','then','lastMinute','info','getUsageRessourcesStatsAndSave','httpCodesStoragePath','Error\x20getting\x20CPU\x20usage:','method','readFile','cadviewer/settings/ressources-usage-stats.json','push','Error\x20getting\x20memory\x20usage:','middleware','9555070fQmnPT','ressourcesUsageStatsPath','parse','Request\x20monitor\x20initialized.','log','7122135TGzGHa','rpsStoragePath','stringify','includes','error','byPath','padStart','toString','memory','init','forEach','filter','1643157TFkoAC','save','=======>','httpCodesData','cadviewer/settings/requests-per-minute.json','1102068krhKNh','path','netstat','outputMb','cadviewer/settings/http-codes-24h.json','now','66687TDAbIf','slice','Initializing\x20request\x20monitor...','node-os-utils','apply','15669ZvWVNL','end','writeFile','usage','rpsData','cpu','statusCode','inputMb','Error\x20saving\x20monitoring\x20data:','byCodes'];a2_0x128b=function(){return _0x2d8beb;};return a2_0x128b();}
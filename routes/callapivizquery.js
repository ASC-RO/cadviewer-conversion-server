function a3_0x55ed(){const _0x57f55f=['express','VizQuery_ID','parse','replace','Initialization\x20configuration\x20file\x20not\x20found','Router','Failed\x20to\x20save\x20configuration\x20file','/config-file','65817zeMZli','1264AgpVFr','438418ylbyDJ','Configuration\x20file\x20saved\x20successfully','VizQuery_Space','../libs/config','svg','join','initialization','message','../CADViewer_config.json','update','error','existsSync','476288GebLQJ','configData','writeFileSync','status','dwg','Update\x20configuration\x20file\x20not\x20found','body','json','json/property','split','extraction','7926pjxmig','386525rgAepl','length','2422psZlgy','Missing\x20required\x20parameters:\x20jsonConfigFilename,\x20contentLocation\x20or\x20configData','cvjs_debug','Invalid\x20JSON\x20data','1090992gOVQcz','Error\x20saving\x20configuration\x20file:','path','createDrawing','mkdirSync','slice','952716TidwHo','Extraction\x20configuration\x20file\x20not\x20found','post'];a3_0x55ed=function(){return _0x57f55f;};return a3_0x55ed();}const a3_0x3e0d55=a3_0x2924;function a3_0x2924(_0x20cbf4,_0x1eee33){const _0x55ed0f=a3_0x55ed();return a3_0x2924=function(_0x2924ec,_0x34441d){_0x2924ec=_0x2924ec-0x15d;let _0xf51260=_0x55ed0f[_0x2924ec];return _0xf51260;},a3_0x2924(_0x20cbf4,_0x1eee33);}(function(_0x2b8d40,_0x72edbe){const _0x4b3633=a3_0x2924,_0x5d1eba=_0x2b8d40();while(!![]){try{const _0x51be02=-parseInt(_0x4b3633(0x18d))/0x1+parseInt(_0x4b3633(0x168))/0x2+-parseInt(_0x4b3633(0x17a))/0x3+parseInt(_0x4b3633(0x180))/0x4+-parseInt(_0x4b3633(0x174))/0x5+-parseInt(_0x4b3633(0x173))/0x6*(parseInt(_0x4b3633(0x176))/0x7)+parseInt(_0x4b3633(0x18c))/0x8*(parseInt(_0x4b3633(0x18b))/0x9);if(_0x51be02===_0x72edbe)break;else _0x5d1eba['push'](_0x5d1eba['shift']());}catch(_0x895366){_0x5d1eba['push'](_0x5d1eba['shift']());}}}(a3_0x55ed,0x4819c));const config=require(a3_0x3e0d55(0x164)),cvjs_debug=config[a3_0x3e0d55(0x178)],fs=require('fs'),path=require(a3_0x3e0d55(0x17c)),{dwgToSvg,initializeFloorplan,updateFloorplan,extractFloorplan}=require('../libs/autoexchange'),express=require(a3_0x3e0d55(0x183)),router=express[a3_0x3e0d55(0x188)](),{getHotConfig}=require(a3_0x3e0d55(0x15f));router[a3_0x3e0d55(0x182)]('',(_0xd2d156,_0x1eab25)=>{const _0x2d32e5=a3_0x3e0d55,{filename:_0x169b7b,action:_0x504fd7,contentLocation:_0xd4157f,initOutputFilename:_0x28b9cb,initConfigFilename:_0x1f5445,updateOutputFilename:_0x1435d5,updateConfigFilename:_0x1da992,extractConfigFilename:_0x437bf5,extractOutputFilename:_0x474ee7,drawingOutputFilename:_0x449e1e}=_0xd2d156['body'];_0x504fd7['initialization']&&(_0x504fd7['extraction']=![]);const _0x8d606d=_0xd4157f['split']('/'),_0x449893=_0x8d606d[_0x8d606d[_0x2d32e5(0x175)]-0x1],_0x14b16f=_0x449893[_0x2d32e5(0x171)]('.')['pop'](),_0x494c11=_0x8d606d[_0x2d32e5(0x17f)](0x0,-0x1)[_0x2d32e5(0x161)]('/');if(_0x504fd7[_0x2d32e5(0x162)]){if(!fs['existsSync'](path[_0x2d32e5(0x161)](_0x494c11,_0x1f5445)))return _0x1eab25['status'](0x190)[_0x2d32e5(0x16f)]({'error':_0x2d32e5(0x187)});}if(_0x504fd7['update']){if(!fs['existsSync'](path[_0x2d32e5(0x161)](_0x494c11,_0x1da992)))return _0x1eab25[_0x2d32e5(0x16b)](0x190)['json']({'error':_0x2d32e5(0x16d)});}if(_0x504fd7['extraction']){if(!fs[_0x2d32e5(0x167)](path[_0x2d32e5(0x161)](_0x494c11,_0x437bf5)))return _0x1eab25[_0x2d32e5(0x16b)](0x190)[_0x2d32e5(0x16f)]({'error':_0x2d32e5(0x181)});}const _0x3bddd1=path[_0x2d32e5(0x161)](_0x494c11,''+_0x28b9cb);_0x504fd7[_0x2d32e5(0x162)]&&initializeFloorplan(_0xd4157f,_0x3bddd1,{'cde':path[_0x2d32e5(0x161)](_0x494c11,_0x1f5445)});const _0x7d0d63=_0x504fd7[_0x2d32e5(0x162)]?_0x3bddd1:_0xd4157f,_0x32065b=path[_0x2d32e5(0x161)](_0x494c11,''+_0x1435d5);_0x504fd7[_0x2d32e5(0x165)]&&updateFloorplan(_0x7d0d63,_0x32065b,{'du2':path[_0x2d32e5(0x161)](_0x494c11,_0x1da992)});const _0x4a9843=_0x504fd7[_0x2d32e5(0x162)]?_0x3bddd1:_0x504fd7['update']?_0x32065b:_0xd4157f,_0x399c7f=path['join'](_0x494c11[_0x2d32e5(0x186)](_0x2d32e5(0x16c),_0x2d32e5(0x170)),''+_0x474ee7);_0x504fd7[_0x2d32e5(0x172)]&&(!fs['existsSync'](_0x494c11['replace'](_0x2d32e5(0x16c),_0x2d32e5(0x170)))&&fs[_0x2d32e5(0x17e)](_0x494c11[_0x2d32e5(0x186)](_0x2d32e5(0x16c),_0x2d32e5(0x170)),{'recursive':!![]}),extractFloorplan(_0x4a9843,_0x399c7f,{'dx2':path[_0x2d32e5(0x161)](_0x494c11,_0x437bf5)}));const _0x2640f7=_0x504fd7[_0x2d32e5(0x162)]?_0x3bddd1:_0x504fd7[_0x2d32e5(0x165)]?_0x32065b:_0xd4157f,_0xdc4b7f=path[_0x2d32e5(0x161)](_0x494c11['replace'](_0x2d32e5(0x16c),_0x2d32e5(0x160)),''+_0x449e1e);_0x504fd7[_0x2d32e5(0x17d)]&&(!fs[_0x2d32e5(0x167)](_0x494c11[_0x2d32e5(0x186)]('dwg',_0x2d32e5(0x160)))&&fs[_0x2d32e5(0x17e)](_0x494c11[_0x2d32e5(0x186)]('dwg',_0x2d32e5(0x160)),{'recursive':!![]}),dwgToSvg(_0x2640f7,_0xdc4b7f,{'f':_0x2d32e5(0x160),'last':'','extents':'','rl':_0x2d32e5(0x15e),'tl':_0x2d32e5(0x184)})),_0x1eab25[_0x2d32e5(0x16b)](0xc8)[_0x2d32e5(0x16f)]({'initial_output_path':_0x504fd7[_0x2d32e5(0x162)]?_0x3bddd1:_0x504fd7['update']?_0x32065b:_0xd4157f,'update_output_path':_0x504fd7[_0x2d32e5(0x165)]?_0x32065b:null,'extracted_output_path':_0x504fd7['extraction']?_0x399c7f:null,'drawing_output_path':_0x504fd7[_0x2d32e5(0x17d)]?_0xdc4b7f:null});}),router[a3_0x3e0d55(0x182)](a3_0x3e0d55(0x18a),(_0x1e7cec,_0x41ef4f)=>{const _0x33afd4=a3_0x3e0d55,{jsonConfigFilename:_0x58bc37,contentLocation:_0x179680}=_0x1e7cec[_0x33afd4(0x16e)],_0x4ef056=_0x1e7cec[_0x33afd4(0x16e)][_0x33afd4(0x169)];if(!_0x58bc37||!_0x179680||!_0x4ef056)return _0x41ef4f['status'](0x190)[_0x33afd4(0x16f)]({'error':_0x33afd4(0x177)});try{let _0x3b138e;try{_0x3b138e=typeof _0x4ef056==='string'?JSON[_0x33afd4(0x185)](_0x4ef056):_0x4ef056;}catch(_0xae516){return _0x41ef4f[_0x33afd4(0x16b)](0x190)[_0x33afd4(0x16f)]({'error':_0x33afd4(0x179)});}const _0x2135d9=_0x179680[_0x33afd4(0x171)]('/'),_0x11c905=_0x2135d9[_0x33afd4(0x17f)](0x0,-0x1)[_0x33afd4(0x161)]('/'),_0x33d34a=_0x58bc37,_0x3e91ec=path[_0x33afd4(0x161)](_0x11c905,_0x33d34a);fs[_0x33afd4(0x16a)](_0x3e91ec,JSON['stringify'](_0x3b138e,null,0x2)),_0x41ef4f[_0x33afd4(0x16b)](0xc8)[_0x33afd4(0x16f)]({'success':!![],'message':_0x33afd4(0x15d),'filePath':_0x3e91ec});}catch(_0x419fec){console[_0x33afd4(0x166)](_0x33afd4(0x17b),_0x419fec),_0x41ef4f['status'](0x1f4)[_0x33afd4(0x16f)]({'error':_0x33afd4(0x189),'details':_0x419fec[_0x33afd4(0x163)]});}}),module['exports']=router;
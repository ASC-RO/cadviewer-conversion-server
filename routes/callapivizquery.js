const a3_0x2363ae=a3_0xd400;(function(_0x4e83ce,_0x466b1d){const _0x30cbd6=a3_0xd400,_0x4fb1d3=_0x4e83ce();while(!![]){try{const _0x315592=-parseInt(_0x30cbd6(0x1f5))/0x1+parseInt(_0x30cbd6(0x20c))/0x2*(parseInt(_0x30cbd6(0x204))/0x3)+-parseInt(_0x30cbd6(0x20b))/0x4*(parseInt(_0x30cbd6(0x1fa))/0x5)+parseInt(_0x30cbd6(0x21c))/0x6*(parseInt(_0x30cbd6(0x212))/0x7)+-parseInt(_0x30cbd6(0x1fd))/0x8*(-parseInt(_0x30cbd6(0x214))/0x9)+-parseInt(_0x30cbd6(0x1fc))/0xa*(parseInt(_0x30cbd6(0x1ff))/0xb)+parseInt(_0x30cbd6(0x225))/0xc*(parseInt(_0x30cbd6(0x21f))/0xd);if(_0x315592===_0x466b1d)break;else _0x4fb1d3['push'](_0x4fb1d3['shift']());}catch(_0x41273e){_0x4fb1d3['push'](_0x4fb1d3['shift']());}}}(a3_0x4938,0x3b36f));function a3_0xd400(_0x4eaecd,_0x584032){const _0x493873=a3_0x4938();return a3_0xd400=function(_0xd400ed,_0x10a1ab){_0xd400ed=_0xd400ed-0x1f1;let _0x4ed01b=_0x493873[_0xd400ed];return _0x4ed01b;},a3_0xd400(_0x4eaecd,_0x584032);}function a3_0x4938(){const _0x4126ca=['pop','Invalid\x20JSON\x20data','replace','json','../libs/config','77VMTbuV','Configuration\x20file\x20saved\x20successfully','436473JSgHzd','stringify','existsSync','configData','exports','VizQuery_Space','svg','split','192222RXPlhx','Missing\x20required\x20parameters:\x20jsonConfigFilename,\x20contentLocation\x20or\x20configData','join','13wLXJKB','parse','extraction','createDrawing','error','Failed\x20to\x20save\x20configuration\x20file','6177396umHRHd','slice','mkdirSync','json/property','../CADViewer_config.json','37809Ugplxk','Initialization\x20configuration\x20file\x20not\x20found','initialization','dwg','update','2800pdlMCJ','message','82760EgKqpY','16wUEPoP','/config-file','583JeUldq','post','Extraction\x20configuration\x20file\x20not\x20found','status','express','34554hiICjd','../libs/autoexchange','string','Router','cvjs_debug','writeFileSync','body','1916rkiFBd','4riBopo'];a3_0x4938=function(){return _0x4126ca;};return a3_0x4938();}const config=require(a3_0x2363ae(0x1f4)),cvjs_debug=config[a3_0x2363ae(0x208)],fs=require('fs'),path=require('path'),{dwgToSvg,initializeFloorplan,updateFloorplan,extractFloorplan}=require(a3_0x2363ae(0x205)),express=require(a3_0x2363ae(0x203)),router=express[a3_0x2363ae(0x207)](),{getHotConfig}=require(a3_0x2363ae(0x211));router[a3_0x2363ae(0x200)]('',(_0x3073a4,_0x313fc7)=>{const _0x4ef925=a3_0x2363ae,{filename:_0x4f50be,action:_0x1ac99e,contentLocation:_0x3194ff,initOutputFilename:_0x1d4da2,initConfigFilename:_0x5a8a7b,updateOutputFilename:_0x28ad13,updateConfigFilename:_0x413dd0,extractConfigFilename:_0x209586,extractOutputFilename:_0x540285,drawingOutputFilename:_0x248e9f}=_0x3073a4[_0x4ef925(0x20a)];_0x1ac99e[_0x4ef925(0x1f7)]&&(_0x1ac99e['extraction']=![]);const _0x45f56e=_0x3194ff[_0x4ef925(0x21b)]('/'),_0x9ff86=_0x45f56e[_0x45f56e['length']-0x1],_0x1976a5=_0x9ff86[_0x4ef925(0x21b)]('.')[_0x4ef925(0x20d)](),_0x15c46a=_0x45f56e[_0x4ef925(0x1f1)](0x0,-0x1)[_0x4ef925(0x21e)]('/');if(_0x1ac99e[_0x4ef925(0x1f7)]){if(!fs[_0x4ef925(0x216)](path['join'](_0x15c46a,_0x5a8a7b)))return _0x313fc7['status'](0x190)['json']({'error':_0x4ef925(0x1f6)});}if(_0x1ac99e[_0x4ef925(0x1f9)]){if(!fs[_0x4ef925(0x216)](path[_0x4ef925(0x21e)](_0x15c46a,_0x413dd0)))return _0x313fc7[_0x4ef925(0x202)](0x190)['json']({'error':'Update\x20configuration\x20file\x20not\x20found'});}if(_0x1ac99e[_0x4ef925(0x221)]){if(!fs['existsSync'](path[_0x4ef925(0x21e)](_0x15c46a,_0x209586)))return _0x313fc7[_0x4ef925(0x202)](0x190)[_0x4ef925(0x210)]({'error':_0x4ef925(0x201)});}const _0x38af20=path[_0x4ef925(0x21e)](_0x15c46a,''+_0x1d4da2);_0x1ac99e[_0x4ef925(0x1f7)]&&initializeFloorplan(_0x3194ff,_0x38af20,{'cde':path['join'](_0x15c46a,_0x5a8a7b)});const _0x5495e5=_0x1ac99e[_0x4ef925(0x1f7)]?_0x38af20:_0x3194ff,_0x4973c5=path[_0x4ef925(0x21e)](_0x15c46a,''+_0x28ad13);_0x1ac99e[_0x4ef925(0x1f9)]&&updateFloorplan(_0x5495e5,_0x4973c5,{'du2':path[_0x4ef925(0x21e)](_0x15c46a,_0x413dd0)});const _0xe7b906=_0x1ac99e[_0x4ef925(0x1f7)]?_0x38af20:_0x1ac99e[_0x4ef925(0x1f9)]?_0x4973c5:_0x3194ff,_0x1b1bab=path[_0x4ef925(0x21e)](_0x15c46a[_0x4ef925(0x20f)]('dwg','json/property'),''+_0x540285);_0x1ac99e[_0x4ef925(0x221)]&&(!fs[_0x4ef925(0x216)](_0x15c46a[_0x4ef925(0x20f)](_0x4ef925(0x1f8),_0x4ef925(0x1f3)))&&fs[_0x4ef925(0x1f2)](_0x15c46a[_0x4ef925(0x20f)](_0x4ef925(0x1f8),_0x4ef925(0x1f3)),{'recursive':!![]}),extractFloorplan(_0xe7b906,_0x1b1bab,{'dx2':path[_0x4ef925(0x21e)](_0x15c46a,_0x209586)}));const _0x13cf6e=_0x1ac99e[_0x4ef925(0x1f7)]?_0x38af20:_0x1ac99e[_0x4ef925(0x1f9)]?_0x4973c5:_0x3194ff,_0x2a184a=path[_0x4ef925(0x21e)](_0x15c46a[_0x4ef925(0x20f)](_0x4ef925(0x1f8),'svg'),''+_0x248e9f);_0x1ac99e[_0x4ef925(0x222)]&&(!fs['existsSync'](_0x15c46a[_0x4ef925(0x20f)](_0x4ef925(0x1f8),_0x4ef925(0x21a)))&&fs['mkdirSync'](_0x15c46a[_0x4ef925(0x20f)](_0x4ef925(0x1f8),_0x4ef925(0x21a)),{'recursive':!![]}),dwgToSvg(_0x13cf6e,_0x2a184a,{'f':_0x4ef925(0x21a),'last':'','extents':'','rl':_0x4ef925(0x219),'tl':'VizQuery_ID'})),_0x313fc7[_0x4ef925(0x202)](0xc8)[_0x4ef925(0x210)]({'initial_output_path':_0x1ac99e['initialization']?_0x38af20:_0x1ac99e[_0x4ef925(0x1f9)]?_0x4973c5:_0x3194ff,'update_output_path':_0x1ac99e[_0x4ef925(0x1f9)]?_0x4973c5:null,'extracted_output_path':_0x1ac99e['extraction']?_0x1b1bab:null,'drawing_output_path':_0x1ac99e[_0x4ef925(0x222)]?_0x2a184a:null});}),router[a3_0x2363ae(0x200)](a3_0x2363ae(0x1fe),(_0xeaa6ba,_0x4f62ae)=>{const _0x4c3f29=a3_0x2363ae,{jsonConfigFilename:_0xc91f58,contentLocation:_0x156180}=_0xeaa6ba['body'],_0x557e6c=_0xeaa6ba[_0x4c3f29(0x20a)][_0x4c3f29(0x217)];if(!_0xc91f58||!_0x156180||!_0x557e6c)return _0x4f62ae[_0x4c3f29(0x202)](0x190)['json']({'error':_0x4c3f29(0x21d)});try{let _0x1e0fee;try{_0x1e0fee=typeof _0x557e6c===_0x4c3f29(0x206)?JSON[_0x4c3f29(0x220)](_0x557e6c):_0x557e6c;}catch(_0x37cec2){return _0x4f62ae[_0x4c3f29(0x202)](0x190)[_0x4c3f29(0x210)]({'error':_0x4c3f29(0x20e)});}const _0x3345b2=_0x156180[_0x4c3f29(0x21b)]('/'),_0x218993=_0x3345b2[_0x4c3f29(0x1f1)](0x0,-0x1)[_0x4c3f29(0x21e)]('/'),_0x47a660=_0xc91f58,_0x137218=path['join'](_0x218993,_0x47a660);fs[_0x4c3f29(0x209)](_0x137218,JSON[_0x4c3f29(0x215)](_0x1e0fee,null,0x2)),_0x4f62ae[_0x4c3f29(0x202)](0xc8)['json']({'success':!![],'message':_0x4c3f29(0x213),'filePath':_0x137218});}catch(_0x2da687){console[_0x4c3f29(0x223)]('Error\x20saving\x20configuration\x20file:',_0x2da687),_0x4f62ae[_0x4c3f29(0x202)](0x1f4)[_0x4c3f29(0x210)]({'error':_0x4c3f29(0x224),'details':_0x2da687[_0x4c3f29(0x1fb)]});}}),module[a3_0x2363ae(0x218)]=router;
const a3_0x21dd37=a3_0x1fb5;(function(_0x20df56,_0x2df0ee){const _0x5eb628=a3_0x1fb5,_0x297d15=_0x20df56();while(!![]){try{const _0x37c758=-parseInt(_0x5eb628(0x10f))/0x1+parseInt(_0x5eb628(0x117))/0x2+-parseInt(_0x5eb628(0xfe))/0x3+-parseInt(_0x5eb628(0x10e))/0x4+-parseInt(_0x5eb628(0x106))/0x5*(parseInt(_0x5eb628(0xf9))/0x6)+parseInt(_0x5eb628(0xf3))/0x7*(parseInt(_0x5eb628(0xfd))/0x8)+-parseInt(_0x5eb628(0xf8))/0x9*(-parseInt(_0x5eb628(0x107))/0xa);if(_0x37c758===_0x2df0ee)break;else _0x297d15['push'](_0x297d15['shift']());}catch(_0x10c918){_0x297d15['push'](_0x297d15['shift']());}}}(a3_0x1b11,0x7d988));function a3_0x1b11(){const _0x6d51f6=['290598Vchllb','Missing\x20required\x20parameters:\x20jsonConfigFilename,\x20contentLocation\x20or\x20configData','join','message','svg','../libs/autoexchange','extraction','update','122465KEtjal','69770yZSQGj','json','Router','json/property','existsSync','VizQuery_ID','mkdirSync','1842876waYqFC','996003osBXjJ','configData','slice','Extraction\x20configuration\x20file\x20not\x20found','initialization','error','express','split','716556REUtRQ','createDrawing','exports','pop','Initialization\x20configuration\x20file\x20not\x20found','post','Update\x20configuration\x20file\x20not\x20found','../CADViewer_config.json','VizQuery_Space','dwg','replace','writeFileSync','Configuration\x20file\x20saved\x20successfully','28iCMppL','Error\x20saving\x20configuration\x20file:','parse','status','Invalid\x20JSON\x20data','2007jkAAGT','126INMnME','length','body','/config-file','1336464IhZNXC'];a3_0x1b11=function(){return _0x6d51f6;};return a3_0x1b11();}function a3_0x1fb5(_0x8f97f8,_0x2a3bae){const _0x1b11c9=a3_0x1b11();return a3_0x1fb5=function(_0x1fb5af,_0x298f03){_0x1fb5af=_0x1fb5af-0xeb;let _0x453d05=_0x1b11c9[_0x1fb5af];return _0x453d05;},a3_0x1fb5(_0x8f97f8,_0x2a3bae);}const config=require(a3_0x21dd37(0xed)),cvjs_debug=config['cvjs_debug'],fs=require('fs'),path=require('path'),{dwgToSvg,initializeFloorplan,updateFloorplan,extractFloorplan}=require(a3_0x21dd37(0x103)),express=require(a3_0x21dd37(0x115)),router=express[a3_0x21dd37(0x109)](),{getHotConfig}=require('../libs/config');router[a3_0x21dd37(0xeb)]('',(_0xcc0426,_0x4a5378)=>{const _0x3aeb52=a3_0x21dd37,{filename:_0x2f82ab,action:_0x2324f9,contentLocation:_0x5e94d8,initOutputFilename:_0x526034,initConfigFilename:_0xc51b44,updateOutputFilename:_0x2ea8db,updateConfigFilename:_0x15a826,extractConfigFilename:_0xe7745,extractOutputFilename:_0x1a50dd,drawingOutputFilename:_0x1b3aa6}=_0xcc0426[_0x3aeb52(0xfb)];_0x2324f9[_0x3aeb52(0x113)]&&(_0x2324f9['extraction']=![]);const _0x5332e9=_0x5e94d8[_0x3aeb52(0x116)]('/'),_0x2bfac7=_0x5332e9[_0x5332e9[_0x3aeb52(0xfa)]-0x1],_0x32686d=_0x2bfac7[_0x3aeb52(0x116)]('.')[_0x3aeb52(0x11a)](),_0x3e84d9=_0x5332e9[_0x3aeb52(0x111)](0x0,-0x1)[_0x3aeb52(0x100)]('/');if(_0x2324f9[_0x3aeb52(0x113)]){if(!fs[_0x3aeb52(0x10b)](path[_0x3aeb52(0x100)](_0x3e84d9,_0xc51b44)))return _0x4a5378['status'](0x190)[_0x3aeb52(0x108)]({'error':_0x3aeb52(0x11b)});}if(_0x2324f9['update']){if(!fs[_0x3aeb52(0x10b)](path[_0x3aeb52(0x100)](_0x3e84d9,_0x15a826)))return _0x4a5378[_0x3aeb52(0xf6)](0x190)[_0x3aeb52(0x108)]({'error':_0x3aeb52(0xec)});}if(_0x2324f9['extraction']){if(!fs[_0x3aeb52(0x10b)](path['join'](_0x3e84d9,_0xe7745)))return _0x4a5378[_0x3aeb52(0xf6)](0x190)[_0x3aeb52(0x108)]({'error':_0x3aeb52(0x112)});}const _0x1b444e=path[_0x3aeb52(0x100)](_0x3e84d9,''+_0x526034);_0x2324f9[_0x3aeb52(0x113)]&&initializeFloorplan(_0x5e94d8,_0x1b444e,{'cde':path[_0x3aeb52(0x100)](_0x3e84d9,_0xc51b44)});const _0x9a19eb=_0x2324f9[_0x3aeb52(0x113)]?_0x1b444e:_0x5e94d8,_0x2eac03=path[_0x3aeb52(0x100)](_0x3e84d9,''+_0x2ea8db);_0x2324f9[_0x3aeb52(0x105)]&&updateFloorplan(_0x9a19eb,_0x2eac03,{'du2':path[_0x3aeb52(0x100)](_0x3e84d9,_0x15a826)});const _0xe1d0b1=_0x2324f9[_0x3aeb52(0x113)]?_0x1b444e:_0x2324f9[_0x3aeb52(0x105)]?_0x2eac03:_0x5e94d8,_0x3c6de0=path[_0x3aeb52(0x100)](_0x3e84d9[_0x3aeb52(0xf0)](_0x3aeb52(0xef),_0x3aeb52(0x10a)),''+_0x1a50dd);_0x2324f9['extraction']&&(!fs[_0x3aeb52(0x10b)](_0x3e84d9[_0x3aeb52(0xf0)]('dwg',_0x3aeb52(0x10a)))&&fs['mkdirSync'](_0x3e84d9[_0x3aeb52(0xf0)](_0x3aeb52(0xef),'json/property'),{'recursive':!![]}),extractFloorplan(_0xe1d0b1,_0x3c6de0,{'dx2':path['join'](_0x3e84d9,_0xe7745)}));const _0x257a81=_0x2324f9['initialization']?_0x1b444e:_0x2324f9['update']?_0x2eac03:_0x5e94d8,_0x2970b5=path['join'](_0x3e84d9[_0x3aeb52(0xf0)]('dwg',_0x3aeb52(0x102)),''+_0x1b3aa6);_0x2324f9[_0x3aeb52(0x118)]&&(!fs[_0x3aeb52(0x10b)](_0x3e84d9['replace'](_0x3aeb52(0xef),_0x3aeb52(0x102)))&&fs[_0x3aeb52(0x10d)](_0x3e84d9[_0x3aeb52(0xf0)](_0x3aeb52(0xef),_0x3aeb52(0x102)),{'recursive':!![]}),dwgToSvg(_0x257a81,_0x2970b5,{'f':'svg','last':'','extents':'','rl':_0x3aeb52(0xee),'tl':_0x3aeb52(0x10c)})),_0x4a5378[_0x3aeb52(0xf6)](0xc8)['json']({'initial_output_path':_0x2324f9[_0x3aeb52(0x113)]?_0x1b444e:_0x2324f9[_0x3aeb52(0x105)]?_0x2eac03:_0x5e94d8,'update_output_path':_0x2324f9[_0x3aeb52(0x105)]?_0x2eac03:null,'extracted_output_path':_0x2324f9[_0x3aeb52(0x104)]?_0x3c6de0:null,'drawing_output_path':_0x2324f9[_0x3aeb52(0x118)]?_0x2970b5:null});}),router['post'](a3_0x21dd37(0xfc),(_0x106aa0,_0x246bfb)=>{const _0x3c7cc6=a3_0x21dd37,{jsonConfigFilename:_0x23f5a1,contentLocation:_0x2d5949}=_0x106aa0[_0x3c7cc6(0xfb)],_0x4cd035=_0x106aa0[_0x3c7cc6(0xfb)][_0x3c7cc6(0x110)];if(!_0x23f5a1||!_0x2d5949||!_0x4cd035)return _0x246bfb[_0x3c7cc6(0xf6)](0x190)[_0x3c7cc6(0x108)]({'error':_0x3c7cc6(0xff)});try{let _0x3b21a8;try{_0x3b21a8=typeof _0x4cd035==='string'?JSON[_0x3c7cc6(0xf5)](_0x4cd035):_0x4cd035;}catch(_0x91f1be){return _0x246bfb[_0x3c7cc6(0xf6)](0x190)[_0x3c7cc6(0x108)]({'error':_0x3c7cc6(0xf7)});}const _0x125f4a=_0x2d5949['split']('/'),_0x5c94f=_0x125f4a['slice'](0x0,-0x1)[_0x3c7cc6(0x100)]('/'),_0x2dddfa=_0x23f5a1,_0x315024=path[_0x3c7cc6(0x100)](_0x5c94f,_0x2dddfa);fs[_0x3c7cc6(0xf1)](_0x315024,JSON['stringify'](_0x3b21a8,null,0x2)),_0x246bfb['status'](0xc8)[_0x3c7cc6(0x108)]({'success':!![],'message':_0x3c7cc6(0xf2),'filePath':_0x315024});}catch(_0x400b5a){console[_0x3c7cc6(0x114)](_0x3c7cc6(0xf4),_0x400b5a),_0x246bfb[_0x3c7cc6(0xf6)](0x1f4)[_0x3c7cc6(0x108)]({'error':'Failed\x20to\x20save\x20configuration\x20file','details':_0x400b5a[_0x3c7cc6(0x101)]});}}),module[a3_0x21dd37(0x119)]=router;
function a9_0x5532(_0x1f616d,_0x54e582){const _0x5b72ef=a9_0x5b72();return a9_0x5532=function(_0x5532fd,_0xd0e289){_0x5532fd=_0x5532fd-0x12a;let _0x11e2bc=_0x5b72ef[_0x5532fd];return _0x11e2bc;},a9_0x5532(_0x1f616d,_0x54e582);}const a9_0x52e3ce=a9_0x5532;(function(_0x38f288,_0x16bd13){const _0x1b0559=a9_0x5532,_0x8c199e=_0x38f288();while(!![]){try{const _0x30af04=parseInt(_0x1b0559(0x162))/0x1+parseInt(_0x1b0559(0x13f))/0x2+parseInt(_0x1b0559(0x159))/0x3+-parseInt(_0x1b0559(0x131))/0x4+-parseInt(_0x1b0559(0x160))/0x5*(parseInt(_0x1b0559(0x12c))/0x6)+parseInt(_0x1b0559(0x13e))/0x7+parseInt(_0x1b0559(0x136))/0x8*(-parseInt(_0x1b0559(0x133))/0x9);if(_0x30af04===_0x16bd13)break;else _0x8c199e['push'](_0x8c199e['shift']());}catch(_0x4adee9){_0x8c199e['push'](_0x8c199e['shift']());}}}(a9_0x5b72,0xa8779));const multer=require(a9_0x52e3ce(0x148)),fs=require('fs'),{randomUUID}=require(a9_0x52e3ce(0x12a)),{userFolderMaximumFiles,userFolderMaximumSizeInMB}=require(a9_0x52e3ce(0x135)),conn=require(a9_0x52e3ce(0x14c)),verifyToken=require(a9_0x52e3ce(0x132))['verifyToken'],dir=a9_0x52e3ce(0x13d);!fs['existsSync'](dir)&&fs[a9_0x52e3ce(0x15a)](dir);const express=require('express'),router=express[a9_0x52e3ce(0x14d)](),config=require('../CADViewer_config.json'),storage=multer[a9_0x52e3ce(0x137)]({'destination':function(_0x2c8233,_0x588862,_0x42fe12){const _0x415f1f=a9_0x52e3ce;_0x42fe12(null,_0x415f1f(0x13b));}}),upload=multer({'storage':storage});router['post']('/files',upload[a9_0x52e3ce(0x12b)]('files'),verifyToken,async(_0x1b3bc6,_0x4b526d,_0x54f320)=>{const _0x5e8799=a9_0x52e3ce,_0x4a0ec2=_0x1b3bc6[_0x5e8799(0x15c)],{global:_0x54afee,path:_0x56748c}=_0x1b3bc6[_0x5e8799(0x150)],_0x2f360c=config[_0x5e8799(0x14e)];console['log']({'global':_0x54afee}),console[_0x5e8799(0x14f)](_0x4a0ec2),console['log']({'user':_0x1b3bc6[_0x5e8799(0x12f)]});if(_0x54afee){_0x4a0ec2[_0x5e8799(0x140)](_0x620682=>{const _0x25d4aa=_0x5e8799;fs[_0x25d4aa(0x138)](_0x620682[_0x25d4aa(0x12d)],(_0x56748c||_0x2f360c)+'/'+_0x620682[_0x25d4aa(0x161)]),fs['unlinkSync'](_0x620682['path']);}),_0x4b526d[_0x5e8799(0x13a)]({'files':_0x4a0ec2[_0x5e8799(0x156)](_0x46d1da=>({..._0x46d1da,'path':(_0x56748c||_0x2f360c)+'/'+_0x46d1da[_0x5e8799(0x161)]}))});return;}let _0xc944cb;try{const [_0x55ded8]=await conn[_0x5e8799(0x13c)]()['execute']('SELECT\x20*\x20FROM\x20`users`\x20WHERE\x20`email`\x20=\x20?',[_0x1b3bc6[_0x5e8799(0x12f)][_0x5e8799(0x134)]]);_0x55ded8[_0x5e8799(0x152)]>0x0&&(_0xc944cb=_0x55ded8[0x0]);}catch(_0x5672b4){console[_0x5e8799(0x14f)]({'err':_0x5672b4}),_0x4b526d[_0x5e8799(0x155)](0x1f4)[_0x5e8799(0x15b)]({'error':_0x5e8799(0x12e)});return;}if(!_0xc944cb){_0x4b526d[_0x5e8799(0x155)](0x191)[_0x5e8799(0x15b)]({'error':_0x5e8799(0x15f)});return;}let _0x155e4d=_0xc944cb[_0x5e8799(0x153)];if(!_0x155e4d){_0x155e4d=randomUUID();try{await conn['promise']()[_0x5e8799(0x154)](_0x5e8799(0x151),[_0x155e4d,_0x1b3bc6[_0x5e8799(0x12f)][_0x5e8799(0x134)]]);}catch(_0x18331f){console[_0x5e8799(0x14f)]({'err':_0x18331f}),_0x4b526d[_0x5e8799(0x155)](0x1f4)[_0x5e8799(0x15b)]({'error':'Error!\x20Something\x20went\x20wrong.'});return;}}const _0x4868e7='./uploads/'+_0x155e4d;!fs['existsSync'](_0x4868e7)&&fs[_0x5e8799(0x15a)](_0x4868e7);if(!_0x4a0ec2){const _0x276398=new Error(_0x5e8799(0x146));return _0x276398[_0x5e8799(0x141)]=0x190,_0x54f320(_0x276398);}const _0x318ed1=fs['readdirSync'](_0x4868e7)[_0x5e8799(0x152)]+_0x4a0ec2[_0x5e8799(0x152)];console[_0x5e8799(0x14f)]({'numberOfSize':_0x318ed1});if(_0x318ed1>userFolderMaximumFiles)return _0x4b526d['status'](0x190)[_0x5e8799(0x15b)]({'error':_0x5e8799(0x147)+userFolderMaximumFiles+_0x5e8799(0x142)});const _0x33e7b4=fs['readdirSync'](_0x4868e7)[_0x5e8799(0x143)]((_0x509592,_0xeb1203)=>_0x509592+fs[_0x5e8799(0x158)](_0x4868e7+'/'+_0xeb1203)[_0x5e8799(0x144)],0x0),_0x2116d0=_0x4a0ec2['reduce']((_0x1dbcf5,_0x4f292b)=>_0x1dbcf5+_0x4f292b[_0x5e8799(0x144)],0x0);console[_0x5e8799(0x14f)]({'totalSize':_0x33e7b4,'uploadedSize':_0x2116d0});if(_0x2116d0+_0x33e7b4>userFolderMaximumSizeInMB*0x400*0x400)return _0x4b526d[_0x5e8799(0x155)](0x190)['json']({'error':_0x5e8799(0x147)+userFolderMaximumSizeInMB+'\x20MB\x20of\x20files'});_0x4a0ec2[_0x5e8799(0x140)](_0x5492f7=>{const _0x1e6eeb=_0x5e8799;fs[_0x1e6eeb(0x138)](_0x5492f7[_0x1e6eeb(0x12d)],_0x4868e7+'/'+_0x5492f7[_0x1e6eeb(0x161)]),fs[_0x1e6eeb(0x157)](_0x5492f7['path']);}),_0x4b526d[_0x5e8799(0x13a)]({'files':_0x4a0ec2['map'](_0x48af93=>({..._0x48af93,'path':_0x4868e7+'/'+_0x48af93['originalname']}))});}),router[a9_0x52e3ce(0x139)](a9_0x52e3ce(0x14a),verifyToken,async(_0x51a7f1,_0x2fb2f7)=>{const _0x1bd544=a9_0x52e3ce,{path:_0x24d9d2,folder_name:_0x1d960b}=_0x51a7f1[_0x1bd544(0x150)];console['log']({'path':_0x24d9d2,'folder_name':_0x1d960b});if(!_0x24d9d2)return _0x2fb2f7[_0x1bd544(0x155)](0x190)[_0x1bd544(0x15b)]({'error':_0x1bd544(0x15d)});if(!_0x1d960b)return _0x2fb2f7['status'](0x190)[_0x1bd544(0x15b)]({'error':'Folder\x20name\x20is\x20required'});const _0x1c8921=_0x24d9d2+'/'+_0x1d960b;!fs[_0x1bd544(0x149)](_0x1c8921)&&fs[_0x1bd544(0x15a)](_0x1c8921),_0x2fb2f7[_0x1bd544(0x13a)]({'path':_0x1c8921});}),router[a9_0x52e3ce(0x15e)](a9_0x52e3ce(0x14b),verifyToken,async(_0x2f759e,_0x22e28f)=>{const _0x362182=a9_0x52e3ce,{isFolder:_0x52ec61,path:_0x6ee496}=_0x2f759e[_0x362182(0x150)];!_0x52ec61?fs[_0x362182(0x157)](_0x6ee496):fs[_0x362182(0x130)](_0x6ee496,{'recursive':!![]}),_0x22e28f[_0x362182(0x13a)]({'success':!![]});}),module[a9_0x52e3ce(0x145)]=router;function a9_0x5b72(){const _0x53170c=['/folder','/remove','../libs/mysql.js','Router','folderLocation','log','body','UPDATE\x20`users`\x20SET\x20`folder_name`\x20=\x20?\x20WHERE\x20`email`\x20=\x20?','length','folder_name','execute','status','map','unlinkSync','statSync','3648222kiWayV','mkdirSync','json','files','Path\x20is\x20required','delete','Invalid\x20user','15SNPMEV','originalname','1319357EUuMgl','crypto','array','2654994KrZjiB','path','Error!\x20Something\x20went\x20wrong.','user','rmdirSync','1262576VuNFrX','../libs/jwt','13974489qqJbUv','email','../CADViewer_config.json','8rLynjb','diskStorage','copyFileSync','post','send','uploads','promise','./uploads','5990922tifrcH','989252UdsYEm','forEach','httpStatusCode','\x20files','reduce','size','exports','Please\x20upload\x20a\x20file','You\x20can\x20only\x20upload\x20a\x20maximum\x20of\x20','multer','existsSync'];a9_0x5b72=function(){return _0x53170c;};return a9_0x5b72();}
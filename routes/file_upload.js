const a9_0x36f9c0=a9_0x61f6;(function(_0x46aec6,_0x70237a){const _0x289529=a9_0x61f6,_0x3ac782=_0x46aec6();while(!![]){try{const _0x20e033=parseInt(_0x289529(0x1c9))/0x1+-parseInt(_0x289529(0x1be))/0x2+-parseInt(_0x289529(0x1bb))/0x3*(-parseInt(_0x289529(0x1cb))/0x4)+-parseInt(_0x289529(0x1b6))/0x5+parseInt(_0x289529(0x1a1))/0x6*(parseInt(_0x289529(0x1cf))/0x7)+parseInt(_0x289529(0x1a3))/0x8+-parseInt(_0x289529(0x1a8))/0x9*(-parseInt(_0x289529(0x1c5))/0xa);if(_0x20e033===_0x70237a)break;else _0x3ac782['push'](_0x3ac782['shift']());}catch(_0x3c5a04){_0x3ac782['push'](_0x3ac782['shift']());}}}(a9_0x3880,0xbf656));const multer=require(a9_0x36f9c0(0x1a9)),fs=require('fs'),{randomUUID}=require(a9_0x36f9c0(0x1af)),{userFolderMaximumFiles,userFolderMaximumSizeInMB}=require(a9_0x36f9c0(0x1ab)),conn=require(a9_0x36f9c0(0x1cd)),verifyToken=require(a9_0x36f9c0(0x1c7))[a9_0x36f9c0(0x1c1)],dir='./uploads';!fs[a9_0x36f9c0(0x1b8)](dir)&&fs[a9_0x36f9c0(0x19e)](dir);function a9_0x61f6(_0x14e5e6,_0x5935bc){const _0x388025=a9_0x3880();return a9_0x61f6=function(_0x61f613,_0x2e22e0){_0x61f613=_0x61f613-0x19d;let _0x455377=_0x388025[_0x61f613];return _0x455377;},a9_0x61f6(_0x14e5e6,_0x5935bc);}const express=require('express'),router=express[a9_0x36f9c0(0x1a5)](),config=require(a9_0x36f9c0(0x1ab)),storage=multer['diskStorage']({'destination':function(_0x1796bc,_0x43d7e0,_0x54f046){_0x54f046(null,'uploads');}}),upload=multer({'storage':storage});function a9_0x3880(){const _0x14dd8e=['size','2606812jWZvPA','httpStatusCode','\x20files','verifyToken','email','map','Folder\x20name\x20is\x20required','10UMzmdv','SELECT\x20*\x20FROM\x20`users`\x20WHERE\x20`email`\x20=\x20?','../libs/jwt','/folder','472262HYtkoW','forEach','1480MwKpdo','Please\x20upload\x20a\x20file','../libs/mysql.js','body','7vWahET','promise','folderLocation','Path\x20is\x20required','You\x20can\x20only\x20upload\x20a\x20maximum\x20of\x20','/files','/remove','mkdirSync','files','log','1260276EfmLbZ','statSync','1089280YhcXRW','reduce','Router','UPDATE\x20`users`\x20SET\x20`folder_name`\x20=\x20?\x20WHERE\x20`email`\x20=\x20?','send','11552895XYkfoz','multer','execute','../CADViewer_config.json','length','copyFileSync','Invalid\x20user','crypto','./uploads/','path','post','user','json','unlinkSync','7793845IEJzgZ','originalname','existsSync','\x20MB\x20of\x20files','status','12519MFfeIT','exports'];a9_0x3880=function(){return _0x14dd8e;};return a9_0x3880();}router[a9_0x36f9c0(0x1b2)](a9_0x36f9c0(0x1d4),upload['array']('files'),verifyToken,async(_0xcea757,_0x34d2d5,_0xb05fbb)=>{const _0x505236=a9_0x36f9c0,_0x51da3f=_0xcea757[_0x505236(0x19f)],{global:_0x47ea13,path:_0xa1474a}=_0xcea757[_0x505236(0x1ce)],_0x2e498e=config[_0x505236(0x1d1)];console[_0x505236(0x1a0)]({'global':_0x47ea13}),console[_0x505236(0x1a0)](_0x51da3f),console[_0x505236(0x1a0)]({'user':_0xcea757[_0x505236(0x1b3)]});if(_0x47ea13){_0x51da3f[_0x505236(0x1ca)](_0x33c18c=>{const _0x192460=_0x505236;fs['copyFileSync'](_0x33c18c[_0x192460(0x1b1)],(_0xa1474a||_0x2e498e)+'/'+_0x33c18c['originalname']),fs[_0x192460(0x1b5)](_0x33c18c[_0x192460(0x1b1)]);}),_0x34d2d5['send']({'files':_0x51da3f[_0x505236(0x1c3)](_0x37d488=>({..._0x37d488,'path':(_0xa1474a||_0x2e498e)+'/'+_0x37d488['originalname']}))});return;}let _0x3b6b23;try{const [_0x3af79b]=await conn[_0x505236(0x1d0)]()[_0x505236(0x1aa)](_0x505236(0x1c6),[_0xcea757[_0x505236(0x1b3)]['email']]);_0x3af79b[_0x505236(0x1ac)]>0x0&&(_0x3b6b23=_0x3af79b[0x0]);}catch(_0x20f372){console['log']({'err':_0x20f372}),_0x34d2d5[_0x505236(0x1ba)](0x1f4)[_0x505236(0x1b4)]({'error':'Error!\x20Something\x20went\x20wrong.'});return;}if(!_0x3b6b23){_0x34d2d5[_0x505236(0x1ba)](0x191)[_0x505236(0x1b4)]({'error':_0x505236(0x1ae)});return;}let _0x12c036=_0x3b6b23['folder_name'];if(!_0x12c036){_0x12c036=randomUUID();try{await conn[_0x505236(0x1d0)]()[_0x505236(0x1aa)](_0x505236(0x1a6),[_0x12c036,_0xcea757[_0x505236(0x1b3)][_0x505236(0x1c2)]]);}catch(_0x366466){console[_0x505236(0x1a0)]({'err':_0x366466}),_0x34d2d5[_0x505236(0x1ba)](0x1f4)['json']({'error':'Error!\x20Something\x20went\x20wrong.'});return;}}const _0x573fda=_0x505236(0x1b0)+_0x12c036;!fs[_0x505236(0x1b8)](_0x573fda)&&fs[_0x505236(0x19e)](_0x573fda);if(!_0x51da3f){const _0x2dfa48=new Error(_0x505236(0x1cc));return _0x2dfa48[_0x505236(0x1bf)]=0x190,_0xb05fbb(_0x2dfa48);}const _0x124f43=fs['readdirSync'](_0x573fda)[_0x505236(0x1ac)]+_0x51da3f[_0x505236(0x1ac)];console[_0x505236(0x1a0)]({'numberOfSize':_0x124f43});if(_0x124f43>userFolderMaximumFiles)return _0x34d2d5[_0x505236(0x1ba)](0x190)[_0x505236(0x1b4)]({'error':_0x505236(0x1d3)+userFolderMaximumFiles+_0x505236(0x1c0)});const _0x5e30b3=fs['readdirSync'](_0x573fda)[_0x505236(0x1a4)]((_0x6b1529,_0xa5f03b)=>_0x6b1529+fs[_0x505236(0x1a2)](_0x573fda+'/'+_0xa5f03b)['size'],0x0),_0x385078=_0x51da3f[_0x505236(0x1a4)]((_0x50c22b,_0x4f0686)=>_0x50c22b+_0x4f0686[_0x505236(0x1bd)],0x0);console[_0x505236(0x1a0)]({'totalSize':_0x5e30b3,'uploadedSize':_0x385078});if(_0x385078+_0x5e30b3>userFolderMaximumSizeInMB*0x400*0x400)return _0x34d2d5[_0x505236(0x1ba)](0x190)[_0x505236(0x1b4)]({'error':_0x505236(0x1d3)+userFolderMaximumSizeInMB+_0x505236(0x1b9)});_0x51da3f['forEach'](_0x20cfbd=>{const _0x48746d=_0x505236;fs[_0x48746d(0x1ad)](_0x20cfbd['path'],_0x573fda+'/'+_0x20cfbd['originalname']),fs[_0x48746d(0x1b5)](_0x20cfbd[_0x48746d(0x1b1)]);}),_0x34d2d5['send']({'files':_0x51da3f[_0x505236(0x1c3)](_0x50db17=>({..._0x50db17,'path':_0x573fda+'/'+_0x50db17[_0x505236(0x1b7)]}))});}),router['post'](a9_0x36f9c0(0x1c8),verifyToken,async(_0x174b4a,_0x1a9b9d)=>{const _0x3b5b39=a9_0x36f9c0,{path:_0x1ef6a2,folder_name:_0x505378}=_0x174b4a[_0x3b5b39(0x1ce)];console['log']({'path':_0x1ef6a2,'folder_name':_0x505378});if(!_0x1ef6a2)return _0x1a9b9d[_0x3b5b39(0x1ba)](0x190)[_0x3b5b39(0x1b4)]({'error':_0x3b5b39(0x1d2)});if(!_0x505378)return _0x1a9b9d[_0x3b5b39(0x1ba)](0x190)[_0x3b5b39(0x1b4)]({'error':_0x3b5b39(0x1c4)});const _0x195efb=_0x1ef6a2+'/'+_0x505378;!fs['existsSync'](_0x195efb)&&fs[_0x3b5b39(0x19e)](_0x195efb),_0x1a9b9d[_0x3b5b39(0x1a7)]({'path':_0x195efb});}),router['delete'](a9_0x36f9c0(0x19d),verifyToken,async(_0x5530db,_0x2c708d)=>{const _0x425980=a9_0x36f9c0,{isFolder:_0x1f57a9,path:_0x2f341c}=_0x5530db[_0x425980(0x1ce)];!_0x1f57a9?fs[_0x425980(0x1b5)](_0x2f341c):fs['rmdirSync'](_0x2f341c,{'recursive':!![]}),_0x2c708d[_0x425980(0x1a7)]({'success':!![]});}),module[a9_0x36f9c0(0x1bc)]=router;